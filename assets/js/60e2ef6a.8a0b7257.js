"use strict";(globalThis.webpackChunknautilus_trader=globalThis.webpackChunknautilus_trader||[]).push([[8974],{6398:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"concepts/portfolio","title":"Portfolio","description":"We are currently working on this concept guide.","source":"@site/docs/concepts/portfolio.md","sourceDirName":"concepts","slug":"/concepts/portfolio","permalink":"/concepts/portfolio","draft":false,"unlisted":false,"editUrl":"https://github.com/Aloento/NautilusTraderDoc/tree/main/docs/concepts/portfolio.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/concepts/overview"},"next":{"title":"Positions","permalink":"/concepts/positions"}}');var s=n(7259),r=n(9087);const o={},a="Portfolio",l={},c=[{value:"Portfolio statistics",id:"portfolio-statistics",level:2},{value:"Custom statistics",id:"custom-statistics",level:2},{value:"Backtest analysis",id:"backtest-analysis",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"portfolio",children:"Portfolio"})}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsx)(t.p,{children:"We are currently working on this concept guide."})}),"\n",(0,s.jsx)(t.p,{children:"The Portfolio serves as the central hub for managing and tracking all positions across active strategies for the trading node or backtest.\nIt consolidates position data from multiple instruments, providing a unified view of your holdings, risk exposure, and overall performance.\nExplore this section to understand how NautilusTrader aggregates and updates portfolio state to support effective trading and risk management."}),"\n",(0,s.jsx)(t.h2,{id:"portfolio-statistics",children:"Portfolio statistics"}),"\n",(0,s.jsxs)(t.p,{children:["There are a variety of ",(0,s.jsx)(t.a,{href:"https://github.com/nautechsystems/nautilus_trader/tree/develop/nautilus_trader/analysis/statistics",children:"built-in portfolio statistics"}),"\nwhich are used to analyse a trading portfolios performance for both backtests and live trading."]}),"\n",(0,s.jsx)(t.p,{children:"The statistics are generally categorized as follows."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"PnLs based statistics (per currency)"}),"\n",(0,s.jsx)(t.li,{children:"Returns based statistics"}),"\n",(0,s.jsx)(t.li,{children:"Positions based statistics"}),"\n",(0,s.jsx)(t.li,{children:"Orders based statistics"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["It's also possible to call a traders ",(0,s.jsx)(t.code,{children:"PortfolioAnalyzer"})," and calculate statistics at any arbitrary\ntime, including ",(0,s.jsx)(t.em,{children:"during"})," a backtest, or live trading session."]}),"\n",(0,s.jsx)(t.h2,{id:"custom-statistics",children:"Custom statistics"}),"\n",(0,s.jsxs)(t.p,{children:["Custom portfolio statistics can be defined by inheriting from the ",(0,s.jsx)(t.code,{children:"PortfolioStatistic"}),"\nbase class, and implementing any of the ",(0,s.jsx)(t.code,{children:"calculate_"})," methods."]}),"\n",(0,s.jsxs)(t.p,{children:["For example, the following is the implementation for the built-in ",(0,s.jsx)(t.code,{children:"WinRate"})," statistic:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import pandas as pd\nfrom typing import Any\nfrom nautilus_trader.analysis.statistic import PortfolioStatistic\n\n\nclass WinRate(PortfolioStatistic):\n    """\n    Calculates the win rate from a realized PnLs series.\n    """\n\n    def calculate_from_realized_pnls(self, realized_pnls: pd.Series) -> Any | None:\n        # Preconditions\n        if realized_pnls is None or realized_pnls.empty:\n            return 0.0\n\n        # Calculate statistic\n        winners = [x for x in realized_pnls if x > 0.0]\n        losers = [x for x in realized_pnls if x &lt;= 0.0]\n\n        return len(winners) / float(max(1, (len(winners) + len(losers))))\n'})}),"\n",(0,s.jsxs)(t.p,{children:["These statistics can then be registered with a traders ",(0,s.jsx)(t.code,{children:"PortfolioAnalyzer"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"stat = WinRate()\n\n# Register with the portfolio analyzer\nengine.portfolio.analyzer.register_statistic(stat)\n\n:::info\nSee the `PortfolioAnalyzer` [API Reference](../api_reference/analysis.md#class-portfolioanalyzer) for details on available methods.\n:::\n"})}),"\n",(0,s.jsxs)(t.admonition,{type:"tip",children:[(0,s.jsxs)(t.p,{children:["Ensure your statistic is robust to degenerate inputs such as ",(0,s.jsx)(t.code,{children:"None"}),", empty series, or insufficient data."]}),(0,s.jsxs)(t.p,{children:["The expectation is that you would then return ",(0,s.jsx)(t.code,{children:"None"}),", NaN or a reasonable default."]})]}),"\n",(0,s.jsx)(t.h2,{id:"backtest-analysis",children:"Backtest analysis"}),"\n",(0,s.jsxs)(t.p,{children:["Following a backtest run, a performance analysis will be carried out by passing realized PnLs, returns, positions and orders data to each registered\nstatistic in turn, calculating their values (with a default configuration). Any output is then displayed in the tear sheet\nunder the ",(0,s.jsx)(t.code,{children:"Portfolio Performance"})," heading, grouped as."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Realized PnL statistics (per currency)"}),"\n",(0,s.jsx)(t.li,{children:"Returns statistics (for the entire portfolio)"}),"\n",(0,s.jsx)(t.li,{children:"General statistics derived from position and order data (for the entire portfolio)"}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},9087:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(6363);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);
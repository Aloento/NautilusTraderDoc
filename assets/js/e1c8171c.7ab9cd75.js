"use strict";(globalThis.webpackChunknautilus_trader=globalThis.webpackChunknautilus_trader||[]).push([[2668],{9087:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>r});var s=n(6363);const a={},i=s.createContext(a);function d(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),s.createElement(i.Provider,{value:t},e.children)}},9480:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"integrations/databento","title":"Databento","description":"NautilusTrader provides an adapter for integrating with the Databento API and Databento Binary Encoding (DBN) format data.","source":"@site/docs/integrations/databento.md","sourceDirName":"integrations","slug":"/integrations/databento","permalink":"/integrations/databento","draft":false,"unlisted":false,"editUrl":"https://github.com/Aloento/NautilusTraderDoc/tree/main/docs/integrations/databento.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Coinbase International","permalink":"/integrations/coinbase_intx"},"next":{"title":"dYdX","permalink":"/integrations/dydx"}}');var a=n(7259),i=n(9087);const d={},r="Databento",o={},l=[{value:"Overview",id:"overview",level:2},{value:"Examples",id:"examples",level:2},{value:"Databento documentation",id:"databento-documentation",level:2},{value:"Databento Binary Encoding (DBN)",id:"databento-binary-encoding-dbn",level:2},{value:"Supported schemas",id:"supported-schemas",level:2},{value:"Schema considerations",id:"schema-considerations",level:3},{value:"Schema selection for live subscriptions",id:"schema-selection-for-live-subscriptions",level:2},{value:"Quote subscriptions (MBP / L1)",id:"quote-subscriptions-mbp--l1",level:3},{value:"Trade subscriptions",id:"trade-subscriptions",level:3},{value:"Order book depth subscriptions (MBP / L2)",id:"order-book-depth-subscriptions-mbp--l2",level:3},{value:"Order book deltas subscriptions (MBO / L3)",id:"order-book-deltas-subscriptions-mbo--l3",level:3},{value:"Bar subscriptions",id:"bar-subscriptions",level:3},{value:"Custom data type subscriptions",id:"custom-data-type-subscriptions",level:3},{value:"Instrument IDs and symbology",id:"instrument-ids-and-symbology",level:2},{value:"Timestamps",id:"timestamps",level:2},{value:"Data types",id:"data-types",level:2},{value:"Instrument definitions",id:"instrument-definitions",level:3},{value:"MBO (market by order)",id:"mbo-market-by-order",level:3},{value:"MBP-1 (market by price, top-of-book)",id:"mbp-1-market-by-price-top-of-book",level:3},{value:"TBBO and TCBBO (top-of-book with trades)",id:"tbbo-and-tcbbo-top-of-book-with-trades",level:3},{value:"OHLCV (bar aggregates)",id:"ohlcv-bar-aggregates",level:3},{value:"Imbalance &amp; Statistics",id:"imbalance--statistics",level:3},{value:"Performance considerations",id:"performance-considerations",level:2},{value:"Loading DBN data",id:"loading-dbn-data",level:2},{value:"DBN data to a BacktestEngine",id:"dbn-data-to-a-backtestengine",level:3},{value:"DBN data to a ParquetDataCatalog",id:"dbn-data-to-a-parquetdatacatalog",level:3},{value:"Historical loader options",id:"historical-loader-options",level:3},{value:"Loading consolidated data",id:"loading-consolidated-data",level:3},{value:"Real-time client architecture",id:"real-time-client-architecture",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Configuration parameters",id:"configuration-parameters",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"databento",children:"Databento"})}),"\n",(0,a.jsxs)(t.p,{children:["NautilusTrader provides an adapter for integrating with the Databento API and ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/standards-and-conventions/databento-binary-encoding",children:"Databento Binary Encoding (DBN)"})," format data.\nAs Databento is purely a market data provider, there is no execution client provided - although a sandbox environment with simulated execution could still be set up.\nIt's also possible to match Databento data with Interactive Brokers execution, or to calculate traditional asset class signals for crypto trading."]}),"\n",(0,a.jsx)(t.p,{children:"The capabilities of this adapter include:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Loading historical data from DBN files and decoding into Nautilus objects for backtesting or writing to the data catalog."}),"\n",(0,a.jsx)(t.li,{children:"Requesting historical data which is decoded to Nautilus objects to support live trading and backtesting."}),"\n",(0,a.jsx)(t.li,{children:"Subscribing to real-time data feeds which are decoded to Nautilus objects to support live trading and sandbox environments."}),"\n"]}),"\n",(0,a.jsxs)(t.admonition,{type:"tip",children:[(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"https://databento.com/signup",children:"Databento"})," currently offers 125 USD in free data credits (historical data only) for new account sign-ups."]}),(0,a.jsxs)(t.p,{children:["With careful requests, this is more than enough for testing and evaluation purposes.\nWe recommend you make use of the ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/api-reference-historical/metadata/metadata-get-cost",children:"/metadata.get_cost"})," endpoint."]})]}),"\n",(0,a.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(t.p,{children:["The adapter implementation takes the ",(0,a.jsx)(t.a,{href:"https://crates.io/crates/databento",children:"databento-rs"})," crate as a dependency,\nwhich is the official Rust client library provided by Databento."]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["There is ",(0,a.jsx)(t.strong,{children:"no"})," need for an optional extra installation of ",(0,a.jsx)(t.code,{children:"databento"}),", as the core components of the\nadapter are compiled as static libraries and linked automatically during the build process."]})}),"\n",(0,a.jsx)(t.p,{children:"The following adapter classes are available:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"DatabentoDataLoader"}),": Loads Databento Binary Encoding (DBN) data from files."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"DatabentoInstrumentProvider"}),": Integrates with the Databento API (HTTP) to provide latest or historical instrument definitions."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"DatabentoHistoricalClient"}),": Integrates with the Databento API (HTTP) for historical market data requests."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"DatabentoLiveClient"}),": Integrates with the Databento API (raw TCP) for subscribing to real-time data feeds."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"DatabentoDataClient"}),": Provides a ",(0,a.jsx)(t.code,{children:"LiveMarketDataClient"})," implementation for running a trading node in real time."]}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsx)(t.p,{children:"As with the other integration adapters, most users will simply define a configuration for a live trading node (covered below),\nand won't need to necessarily work with these lower level components directly."})}),"\n",(0,a.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsxs)(t.p,{children:["You can find live example scripts ",(0,a.jsx)(t.a,{href:"https://github.com/nautechsystems/nautilus_trader/tree/develop/examples/live/databento/",children:"here"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"databento-documentation",children:"Databento documentation"}),"\n",(0,a.jsxs)(t.p,{children:["Databento provides extensive documentation for new users which can be found in the ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/quickstart/new-user-guides",children:"Databento new users guide"}),".\nWe recommend also referring to the Databento documentation in conjunction with this NautilusTrader integration guide."]}),"\n",(0,a.jsx)(t.h2,{id:"databento-binary-encoding-dbn",children:"Databento Binary Encoding (DBN)"}),"\n",(0,a.jsxs)(t.p,{children:["Databento Binary Encoding (DBN) is an extremely fast message encoding and storage format for normalized market data.\nThe ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/standards-and-conventions/databento-binary-encoding",children:"DBN specification"})," includes a simple, self-describing metadata header and a fixed set of struct definitions,\nwhich enforce a standardized way to normalize market data."]}),"\n",(0,a.jsx)(t.p,{children:"The integration provides a decoder which can convert DBN format data to Nautilus objects."}),"\n",(0,a.jsx)(t.p,{children:"The same Rust implemented Nautilus decoder is used for:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Loading and decoding DBN files from disk."}),"\n",(0,a.jsx)(t.li,{children:"Decoding historical and live data in real time."}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"supported-schemas",children:"Supported schemas"}),"\n",(0,a.jsx)(t.p,{children:"The following Databento schemas are supported by NautilusTrader:"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Databento schema"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Nautilus data type"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/mbo",children:"MBO"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"OrderBookDelta"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Market by order (L3)."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/mbp-1",children:"MBP_1"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"(QuoteTick, TradeTick | None)"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Market by price (L1)."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/mbp-10",children:"MBP_10"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"OrderBookDepth10"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Market depth (L2)."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/bbo-1s",children:"BBO_1S"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"QuoteTick"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"1-second best bid/offer."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/bbo-1m",children:"BBO_1M"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"QuoteTick"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"1-minute best bid/offer."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/cmbp-1",children:"CMBP_1"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"(QuoteTick, TradeTick | None)"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Consolidated MBP across venues."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/cbbo-1s",children:"CBBO_1S"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"QuoteTick"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Consolidated 1-second BBO."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/cbbo-1m",children:"CBBO_1M"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"QuoteTick"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Consolidated 1-minute BBO."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/tcbbo",children:"TCBBO"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"(QuoteTick, TradeTick)"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Trade-sampled consolidated BBO."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/tbbo",children:"TBBO"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"(QuoteTick, TradeTick)"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Trade-sampled best bid/offer."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/trades",children:"TRADES"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"TradeTick"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Trade ticks."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/ohlcv-1s",children:"OHLCV_1S"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"Bar"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"1-second bars."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/ohlcv-1m",children:"OHLCV_1M"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"Bar"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"1-minute bars."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/ohlcv-1h",children:"OHLCV_1H"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"Bar"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"1-hour bars."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/ohlcv-1d",children:"OHLCV_1D"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"Bar"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Daily bars."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/ohlcv-eod",children:"OHLCV_EOD"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"Bar"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"End-of-day bars."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/definition",children:"DEFINITION"})}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"Instrument"})," (various types)"]}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Instrument definitions."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/imbalance",children:"IMBALANCE"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"DatabentoImbalance"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Auction imbalance data."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/statistics",children:"STATISTICS"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"DatabentoStatistics"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Market statistics."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats/status",children:"STATUS"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"InstrumentStatus"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Market status updates."})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"schema-considerations",children:"Schema considerations"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"TBBO and TCBBO"}),": Trade-sampled feeds that pair every trade with the BBO immediately ",(0,a.jsx)(t.em,{children:"before"})," the trade's effect (TBBO per-venue, TCBBO consolidated across venues). Use when you need trades aligned with contemporaneous quotes without managing two streams."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"MBP-1 and CMBP-1 (L1)"}),": Event-level updates; emit trades only on trade events. Choose for a complete top-of-book event tape. For quote+trade alignment, prefer TBBO/TCBBO; otherwise, use TRADES."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"MBP-10 (L2)"}),": Top 10 levels with trades. Good for depth-aware strategies that don't need per-order detail; lighter than MBO with much of the structure you need including number of orders per level."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"MBO (L3)"}),": Per-order events enable queue position modeling and exact book reconstruction. Highest volume/cost; start at node initialization to ensure proper replay context."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"BBO_1S/BBO_1M and CBBO_1S/CBBO_1M"}),": Sampled top-of-book quotes at fixed intervals (1s/1m), no trades. Best for monitoring/spreads/low-cost signal generation; not suited for fine-grained microstructure."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"TRADES"}),": Trades only. Pair with MBP-1 (",(0,a.jsx)(t.code,{children:"include_trades=True"}),") or use TBBO/TCBBO if you need quote context aligned with trades."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"OHLCV_ (incl. OHLCV_EOD)"}),": Aggregated bars derived from trades. Prefer for higher-timeframe analytics/backtests; ensure bar timestamps represent close time (set ",(0,a.jsx)(t.code,{children:"bars_timestamp_on_close=True"}),")."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Imbalance / Statistics / Status"}),": Venue operational data; subscribe via ",(0,a.jsx)(t.code,{children:"subscribe_data"})," with a ",(0,a.jsx)(t.code,{children:"DataType"})," carrying ",(0,a.jsx)(t.code,{children:"instrument_id"})," metadata."]}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Consolidated schemas"})," (CMBP_1, CBBO_1S, CBBO_1M, TCBBO) aggregate data across multiple venues,\nproviding a unified view of the market. These are particularly useful for cross-venue analysis and\nwhen you need a comprehensive market picture."]})}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["See also the Databento ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats",children:"Schemas and data formats"})," guide."]})}),"\n",(0,a.jsx)(t.h2,{id:"schema-selection-for-live-subscriptions",children:"Schema selection for live subscriptions"}),"\n",(0,a.jsx)(t.p,{children:"The following table shows how Nautilus subscription methods map to Databento schemas:"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Nautilus Subscription Method"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Default Schema"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Available Databento Schemas"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Nautilus Data Type"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"subscribe_quote_ticks()"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"mbp-1"})}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"mbp-1"}),", ",(0,a.jsx)(t.code,{children:"bbo-1s"}),", ",(0,a.jsx)(t.code,{children:"bbo-1m"}),", ",(0,a.jsx)(t.code,{children:"cmbp-1"}),", ",(0,a.jsx)(t.code,{children:"cbbo-1s"}),", ",(0,a.jsx)(t.code,{children:"cbbo-1m"}),", ",(0,a.jsx)(t.code,{children:"tbbo"}),", ",(0,a.jsx)(t.code,{children:"tcbbo"})]}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"QuoteTick"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"subscribe_trade_ticks()"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"trades"})}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"trades"}),", ",(0,a.jsx)(t.code,{children:"tbbo"}),", ",(0,a.jsx)(t.code,{children:"tcbbo"}),", ",(0,a.jsx)(t.code,{children:"mbp-1"}),", ",(0,a.jsx)(t.code,{children:"cmbp-1"})]}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"TradeTick"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"subscribe_order_book_depth()"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"mbp-10"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"mbp-10"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"OrderBookDepth10"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"subscribe_order_book_deltas()"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"mbo"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"mbo"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"OrderBookDeltas"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"subscribe_bars()"})}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"varies"}),(0,a.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,a.jsx)(t.code,{children:"ohlcv-1s"}),", ",(0,a.jsx)(t.code,{children:"ohlcv-1m"}),", ",(0,a.jsx)(t.code,{children:"ohlcv-1h"}),", ",(0,a.jsx)(t.code,{children:"ohlcv-1d"})]}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:(0,a.jsx)(t.code,{children:"Bar"})})]})]})]}),"\n",(0,a.jsxs)(t.admonition,{type:"note",children:[(0,a.jsxs)(t.p,{children:["The examples below assume you're within a ",(0,a.jsx)(t.code,{children:"Strategy"})," or ",(0,a.jsx)(t.code,{children:"Actor"})," class context where ",(0,a.jsx)(t.code,{children:"self"})," has access to subscription methods.\nRemember to import the necessary types:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"from nautilus_trader.adapters.databento import DATABENTO_CLIENT_ID\nfrom nautilus_trader.model import BarType\nfrom nautilus_trader.model.enums import BookType\nfrom nautilus_trader.model.identifiers import InstrumentId\n"})})]}),"\n",(0,a.jsx)(t.h3,{id:"quote-subscriptions-mbp--l1",children:"Quote subscriptions (MBP / L1)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Default MBP-1 quotes (may include trades)\nself.subscribe_quote_ticks(instrument_id, client_id=DATABENTO_CLIENT_ID)\n\n# Explicit MBP-1 schema\nself.subscribe_quote_ticks(\n    instrument_id=instrument_id,\n    params={"schema": "mbp-1"},\n    client_id=DATABENTO_CLIENT_ID,\n)\n\n# 1-second BBO snapshots (quotes only, no trades)\nself.subscribe_quote_ticks(\n    instrument_id=instrument_id,\n    params={"schema": "bbo-1s"},\n    client_id=DATABENTO_CLIENT_ID,\n)\n\n# Consolidated quotes across venues\nself.subscribe_quote_ticks(\n    instrument_id=instrument_id,\n    params={"schema": "cbbo-1s"},  # or "cmbp-1" for consolidated MBP\n    client_id=DATABENTO_CLIENT_ID,\n)\n\n# Trade-sampled BBO (includes both quotes AND trades)\nself.subscribe_quote_ticks(\n    instrument_id=instrument_id,\n    params={"schema": "tbbo"},  # Will receive both QuoteTick and TradeTick onto the message bus\n    client_id=DATABENTO_CLIENT_ID,\n)\n'})}),"\n",(0,a.jsx)(t.h3,{id:"trade-subscriptions",children:"Trade subscriptions"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Trade ticks only\nself.subscribe_trade_ticks(instrument_id, client_id=DATABENTO_CLIENT_ID)\n\n# Trades from MBP-1 feed (only when trade events occur)\nself.subscribe_trade_ticks(\n    instrument_id=instrument_id,\n    params={"schema": "mbp-1"},\n    client_id=DATABENTO_CLIENT_ID,\n)\n\n# Trade-sampled data (includes quotes at trade time)\nself.subscribe_trade_ticks(\n    instrument_id=instrument_id,\n    params={"schema": "tbbo"},  # Also provides quotes at trade events\n    client_id=DATABENTO_CLIENT_ID,\n)\n'})}),"\n",(0,a.jsx)(t.h3,{id:"order-book-depth-subscriptions-mbp--l2",children:"Order book depth subscriptions (MBP / L2)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"# Subscribe to top 10 levels of market depth\nself.subscribe_order_book_depth(\n    instrument_id=instrument_id,\n    depth=10  # MBP-10 schema is automatically selected\n)\n\n# The depth parameter must be 10 for Databento\n# This will receive OrderBookDepth10 updates\n"})}),"\n",(0,a.jsx)(t.h3,{id:"order-book-deltas-subscriptions-mbo--l3",children:"Order book deltas subscriptions (MBO / L3)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"# Subscribe to full order book updates (market by order)\nself.subscribe_order_book_deltas(\n    instrument_id=instrument_id,\n    book_type=BookType.L3_MBO  # Uses MBO schema\n)\n\n# Note: MBO subscriptions must be made at node startup for Databento\n# to ensure proper replay from session start\n"})}),"\n",(0,a.jsx)(t.h3,{id:"bar-subscriptions",children:"Bar subscriptions"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Subscribe to 1-minute bars (automatically uses ohlcv-1m schema)\nself.subscribe_bars(\n    bar_type=BarType.from_str(f"{instrument_id}-1-MINUTE-LAST-EXTERNAL")\n)\n\n# Subscribe to 1-second bars (automatically uses ohlcv-1s schema)\nself.subscribe_bars(\n    bar_type=BarType.from_str(f"{instrument_id}-1-SECOND-LAST-EXTERNAL")\n)\n\n# Subscribe to hourly bars (automatically uses ohlcv-1h schema)\nself.subscribe_bars(\n    bar_type=BarType.from_str(f"{instrument_id}-1-HOUR-LAST-EXTERNAL")\n)\n\n# Subscribe to daily bars (automatically uses ohlcv-1d schema)\nself.subscribe_bars(\n    bar_type=BarType.from_str(f"{instrument_id}-1-DAY-LAST-EXTERNAL")\n)\n\n# Subscribe to daily bars with end-of-day schema (only valid for DAY aggregation)\nself.subscribe_bars(\n    bar_type=BarType.from_str(f"{instrument_id}-1-DAY-LAST-EXTERNAL"),\n    params={"schema": "ohlcv-eod"},  # Override to use end-of-day bars\n)\n'})}),"\n",(0,a.jsx)(t.h3,{id:"custom-data-type-subscriptions",children:"Custom data type subscriptions"}),"\n",(0,a.jsxs)(t.p,{children:["For specialized Databento data types like imbalance and statistics, use the generic ",(0,a.jsx)(t.code,{children:"subscribe_data"})," method:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from nautilus_trader.adapters.databento import DATABENTO_CLIENT_ID\nfrom nautilus_trader.adapters.databento import DatabentoImbalance\nfrom nautilus_trader.adapters.databento import DatabentoStatistics\nfrom nautilus_trader.model import DataType\n\n# Subscribe to imbalance data\nself.subscribe_data(\n    data_type=DataType(DatabentoImbalance, metadata={"instrument_id": instrument_id}),\n    client_id=DATABENTO_CLIENT_ID,\n)\n\n# Subscribe to statistics data\nself.subscribe_data(\n    data_type=DataType(DatabentoStatistics, metadata={"instrument_id": instrument_id}),\n    client_id=DATABENTO_CLIENT_ID,\n)\n\n# Subscribe to instrument status updates\nfrom nautilus_trader.model.data import InstrumentStatus\nself.subscribe_data(\n    data_type=DataType(InstrumentStatus, metadata={"instrument_id": instrument_id}),\n    client_id=DATABENTO_CLIENT_ID,\n)\n'})}),"\n",(0,a.jsx)(t.h2,{id:"instrument-ids-and-symbology",children:"Instrument IDs and symbology"}),"\n",(0,a.jsxs)(t.p,{children:["Databento market data includes an ",(0,a.jsx)(t.code,{children:"instrument_id"})," field which is an integer assigned\nby either the original source venue, or internally by Databento during normalization."]}),"\n",(0,a.jsxs)(t.p,{children:["It's important to realize that this is different to the Nautilus ",(0,a.jsx)(t.code,{children:"InstrumentId"}),"\nwhich is a string made up of a symbol + venue with a period separator i.e. ",(0,a.jsx)(t.code,{children:'"{symbol}.{venue}"'}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["The Nautilus decoder will use the Databento ",(0,a.jsx)(t.code,{children:"raw_symbol"})," for the Nautilus ",(0,a.jsx)(t.code,{children:"symbol"})," and an ",(0,a.jsx)(t.a,{href:"https://www.iso20022.org/market-identifier-codes",children:"ISO 10383 MIC"})," (Market Identifier Code)\nfrom the Databento instrument definition message for the Nautilus ",(0,a.jsx)(t.code,{children:"venue"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Databento datasets are identified with a ",(0,a.jsx)(t.em,{children:"dataset ID"})," which is not the same\nas a venue identifier. You can read more about Databento dataset naming conventions ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/api-reference-historical/basics/datasets",children:"here"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Of particular note is for CME Globex MDP 3.0 data (",(0,a.jsx)(t.code,{children:"GLBX.MDP3"})," dataset ID), the following\nexchanges are all grouped under the ",(0,a.jsx)(t.code,{children:"GLBX"})," venue. These mappings can be determined from the\ninstruments ",(0,a.jsx)(t.code,{children:"exchange"})," field:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"CBCM"}),": XCME-XCBT inter-exchange spread"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"NYUM"}),": XNYM-DUMX inter-exchange spread"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"XCBT"}),": Chicago Board of Trade (CBOT)"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"XCEC"}),": Commodities Exchange Center (COMEX)"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"XCME"}),": Chicago Mercantile Exchange (CME)"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"XFXS"}),": CME FX Link spread"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"XNYM"}),": New York Mercantile Exchange (NYMEX)"]}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["Other venue MICs can be found in the ",(0,a.jsx)(t.code,{children:"venue"})," field of responses from the ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/api-reference-historical/metadata/metadata-list-publishers",children:"metadata.list_publishers"})," endpoint."]})}),"\n",(0,a.jsx)(t.h2,{id:"timestamps",children:"Timestamps"}),"\n",(0,a.jsx)(t.p,{children:"Databento data includes various timestamp fields including (but not limited to):"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"ts_event"}),": The matching-engine-received timestamp expressed as the number of nanoseconds since the UNIX epoch."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"ts_in_delta"}),": The matching-engine-sending timestamp expressed as the number of nanoseconds before ",(0,a.jsx)(t.code,{children:"ts_recv"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"ts_recv"}),": The capture-server-received timestamp expressed as the number of nanoseconds since the UNIX epoch."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"ts_out"}),": The Databento sending timestamp."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["Nautilus data includes at ",(0,a.jsx)(t.em,{children:"least"})," two timestamps (required by the ",(0,a.jsx)(t.code,{children:"Data"})," contract):"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"ts_event"}),": UNIX timestamp (nanoseconds) when the data event occurred."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"ts_init"}),": UNIX timestamp (nanoseconds) when the data instance was created."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["When decoding and normalizing Databento to Nautilus we generally assign the Databento ",(0,a.jsx)(t.code,{children:"ts_recv"})," value to the Nautilus\n",(0,a.jsx)(t.code,{children:"ts_event"})," field, as this timestamp is much more reliable and consistent, and is guaranteed to be monotonically increasing per instrument.\nThe exception to this are the ",(0,a.jsx)(t.code,{children:"DatabentoImbalance"})," and ",(0,a.jsx)(t.code,{children:"DatabentoStatistics"})," data types, which have fields for all timestamps as these types are defined specifically for the adapter."]}),"\n",(0,a.jsxs)(t.admonition,{type:"info",children:[(0,a.jsx)(t.p,{children:"See the following Databento docs for further information:"}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/standards-and-conventions/common-fields-enums-types#timestamps",children:"Databento standards and conventions - timestamps"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://databento.com/docs/architecture/timestamping-guide",children:"Databento timestamping guide"})}),"\n"]})]}),"\n",(0,a.jsx)(t.h2,{id:"data-types",children:"Data types"}),"\n",(0,a.jsx)(t.p,{children:"The following section discusses Databento schema -> Nautilus data type equivalence\nand considerations."}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["See Databento ",(0,a.jsx)(t.a,{href:"https://databento.com/docs/schemas-and-data-formats",children:"schemas and data formats"}),"."]})}),"\n",(0,a.jsx)(t.h3,{id:"instrument-definitions",children:"Instrument definitions"}),"\n",(0,a.jsxs)(t.p,{children:["Databento provides a single schema to cover all instrument classes, these are\ndecoded to the appropriate Nautilus ",(0,a.jsx)(t.code,{children:"Instrument"})," types."]}),"\n",(0,a.jsx)(t.p,{children:"The following Databento instrument classes are supported by NautilusTrader:"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Databento instrument class"}),(0,a.jsx)(t.th,{children:"Code"}),(0,a.jsx)(t.th,{children:"Nautilus instrument type"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Stock"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"K"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"Equity"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Future"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"F"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"FuturesContract"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Call"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"C"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"OptionContract"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Put"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"P"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"OptionContract"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Future spread"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"S"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"FuturesSpread"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Option spread"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"T"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"OptionSpread"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Mixed spread"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"M"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"OptionSpread"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"FX spot"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"X"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"CurrencyPair"})})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Bond"}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"B"})}),(0,a.jsx)(t.td,{children:"Not yet available"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"mbo-market-by-order",children:"MBO (market by order)"}),"\n",(0,a.jsxs)(t.p,{children:["This schema is the highest granularity data offered by Databento, and represents\nfull order book depth. Some messages also provide trade information, and so when\ndecoding MBO messages Nautilus will produce an ",(0,a.jsx)(t.code,{children:"OrderBookDelta"})," and optionally a\n",(0,a.jsx)(t.code,{children:"TradeTick"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["The Nautilus live data client will buffer MBO messages until an ",(0,a.jsx)(t.code,{children:"F_LAST"})," flag\nis seen. A discrete ",(0,a.jsx)(t.code,{children:"OrderBookDeltas"})," container object will then be passed to the\nregistered handler."]}),"\n",(0,a.jsxs)(t.p,{children:["Order book snapshots are also buffered into a discrete ",(0,a.jsx)(t.code,{children:"OrderBookDeltas"})," container\nobject, which occurs during the replay startup sequence."]}),"\n",(0,a.jsx)(t.h3,{id:"mbp-1-market-by-price-top-of-book",children:"MBP-1 (market by price, top-of-book)"}),"\n",(0,a.jsxs)(t.p,{children:["This schema represents the top-of-book only (quotes ",(0,a.jsx)(t.em,{children:"and"})," trades). Like with MBO messages, some\nmessages carry trade information, and so when decoding MBP-1 messages Nautilus\nwill produce a ",(0,a.jsx)(t.code,{children:"QuoteTick"})," and ",(0,a.jsx)(t.em,{children:"also"})," a ",(0,a.jsx)(t.code,{children:"TradeTick"})," if the message is a trade."]}),"\n",(0,a.jsx)(t.h3,{id:"tbbo-and-tcbbo-top-of-book-with-trades",children:"TBBO and TCBBO (top-of-book with trades)"}),"\n",(0,a.jsxs)(t.p,{children:["The TBBO (Top Book with Trades) and TCBBO (Top Consolidated Book with Trades) schemas provide\nboth quote and trade data in each message. When subscribing to quotes using these schemas,\nyou'll automatically receive both ",(0,a.jsx)(t.code,{children:"QuoteTick"})," and ",(0,a.jsx)(t.code,{children:"TradeTick"})," data, making them more efficient\nthan subscribing to quotes and trades separately. TCBBO provides consolidated data across venues."]}),"\n",(0,a.jsx)(t.h3,{id:"ohlcv-bar-aggregates",children:"OHLCV (bar aggregates)"}),"\n",(0,a.jsxs)(t.p,{children:["The Databento bar aggregation messages are timestamped at the ",(0,a.jsx)(t.strong,{children:"open"})," of the bar interval.\nThe Nautilus decoder will normalize the ",(0,a.jsx)(t.code,{children:"ts_event"})," timestamps to the ",(0,a.jsx)(t.strong,{children:"close"})," of the bar\n(original ",(0,a.jsx)(t.code,{children:"ts_event"})," + bar interval)."]}),"\n",(0,a.jsx)(t.h3,{id:"imbalance--statistics",children:"Imbalance & Statistics"}),"\n",(0,a.jsxs)(t.p,{children:["The Databento ",(0,a.jsx)(t.code,{children:"imbalance"})," and ",(0,a.jsx)(t.code,{children:"statistics"})," schemas cannot be represented as a built-in Nautilus data types,\nand so they have specific types defined in Rust ",(0,a.jsx)(t.code,{children:"DatabentoImbalance"})," and ",(0,a.jsx)(t.code,{children:"DatabentoStatistics"}),".\nPython bindings are provided via PyO3 (Rust) so the types behave a little differently to built-in Nautilus\ndata types, where all attributes are PyO3 provided objects and not directly compatible\nwith certain methods which may expect a Cython provided type. There are PyO3 -> legacy Cython\nobject conversion methods available, which can be found in the API reference."]}),"\n",(0,a.jsxs)(t.p,{children:["Here is a general pattern for converting a PyO3 ",(0,a.jsx)(t.code,{children:"Price"})," to a Cython ",(0,a.jsx)(t.code,{children:"Price"}),":"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"price = Price.from_raw(pyo3_price.raw, pyo3_price.precision)\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Additionally requesting for and subscribing to these data types requires the use of the\nlower level generic methods for custom data types. The following example subscribes to the ",(0,a.jsx)(t.code,{children:"imbalance"}),"\nschema for the ",(0,a.jsx)(t.code,{children:"AAPL.XNAS"})," instrument (Apple Inc trading on the Nasdaq exchange):"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from nautilus_trader.adapters.databento import DATABENTO_CLIENT_ID\nfrom nautilus_trader.adapters.databento import DatabentoImbalance\nfrom nautilus_trader.model import DataType\n\ninstrument_id = InstrumentId.from_str("AAPL.XNAS")\nself.subscribe_data(\n    data_type=DataType(DatabentoImbalance, metadata={"instrument_id": instrument_id}),\n    client_id=DATABENTO_CLIENT_ID,\n)\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Or requesting the previous days ",(0,a.jsx)(t.code,{children:"statistics"})," schema for the ",(0,a.jsx)(t.code,{children:"ES.FUT"})," parent symbol (all active E-mini S&P 500 futures contracts on the CME Globex exchange):"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from nautilus_trader.adapters.databento import DATABENTO_CLIENT_ID\nfrom nautilus_trader.adapters.databento import DatabentoStatistics\nfrom nautilus_trader.model import DataType\n\ninstrument_id = InstrumentId.from_str("ES.FUT.GLBX")\nmetadata = {\n    "instrument_id": instrument_id,\n    "start": "2024-03-06",\n}\nself.request_data(\n    data_type=DataType(DatabentoStatistics, metadata=metadata),\n    client_id=DATABENTO_CLIENT_ID,\n)\n'})}),"\n",(0,a.jsx)(t.h2,{id:"performance-considerations",children:"Performance considerations"}),"\n",(0,a.jsx)(t.p,{children:"When backtesting with Databento DBN data, there are two options:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["Store the data in DBN (",(0,a.jsx)(t.code,{children:".dbn.zst"}),") format files and decode to Nautilus objects on every run."]}),"\n",(0,a.jsx)(t.li,{children:"Convert the DBN files to Nautilus objects and then write to the data catalog once (stored as Nautilus Parquet format on disk)."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Whilst the DBN -> Nautilus decoder is implemented in Rust and has been optimized,\nthe best performance for backtesting will be achieved by writing the Nautilus\nobjects to the data catalog, which performs the decoding step once."}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"https://arrow.apache.org/datafusion/",children:"DataFusion"})," provides a query engine backend to efficiently load and stream\nthe Nautilus Parquet data from disk, which achieves extremely high throughput (at least an order of magnitude faster\nthan converting DBN -> Nautilus on the fly for every backtest run)."]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsx)(t.p,{children:"Performance benchmarks are currently under development."})}),"\n",(0,a.jsx)(t.h2,{id:"loading-dbn-data",children:"Loading DBN data"}),"\n",(0,a.jsxs)(t.p,{children:["You can load DBN files and convert the records to Nautilus objects using the\n",(0,a.jsx)(t.code,{children:"DatabentoDataLoader"})," class. There are two main purposes for doing so:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["Pass the converted data to ",(0,a.jsx)(t.code,{children:"BacktestEngine.add_data"})," directly for backtesting."]}),"\n",(0,a.jsxs)(t.li,{children:["Pass the converted data to ",(0,a.jsx)(t.code,{children:"ParquetDataCatalog.write_data"})," for later streaming use with a ",(0,a.jsx)(t.code,{children:"BacktestNode"}),"."]}),"\n"]}),"\n",(0,a.jsx)(t.h3,{id:"dbn-data-to-a-backtestengine",children:"DBN data to a BacktestEngine"}),"\n",(0,a.jsxs)(t.p,{children:["This code snippet demonstrates how to load DBN data and pass to a ",(0,a.jsx)(t.code,{children:"BacktestEngine"}),".\nSince the ",(0,a.jsx)(t.code,{children:"BacktestEngine"})," needs an instrument added, we'll use a test instrument\nprovided by the ",(0,a.jsx)(t.code,{children:"TestInstrumentProvider"})," (you could also pass an instrument object\nwhich was parsed from a DBN file too).\nThe data is a month of TSLA (Tesla Inc) trades on the Nasdaq exchange:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Add instrument\nTSLA_NASDAQ = TestInstrumentProvider.equity(symbol="TSLA")\nengine.add_instrument(TSLA_NASDAQ)\n\n# Decode data to legacy Cython objects\nloader = DatabentoDataLoader()\ntrades = loader.from_dbn_file(\n    path=TEST_DATA_DIR / "databento" / "temp" / "tsla-xnas-20240107-20240206.trades.dbn.zst",\n    instrument_id=TSLA_NASDAQ.id,\n)\n\n# Add data\nengine.add_data(trades)\n'})}),"\n",(0,a.jsx)(t.h3,{id:"dbn-data-to-a-parquetdatacatalog",children:"DBN data to a ParquetDataCatalog"}),"\n",(0,a.jsxs)(t.p,{children:["This code snippet demonstrates how to load DBN data and write to a ",(0,a.jsx)(t.code,{children:"ParquetDataCatalog"}),".\nWe pass a value of false for the ",(0,a.jsx)(t.code,{children:"as_legacy_cython"})," flag, which will ensure the\nDBN records are decoded as PyO3 (Rust) objects. It's worth noting that legacy Cython\nobjects can also be passed to ",(0,a.jsx)(t.code,{children:"write_data"}),", but these need to be converted back to\npyo3 objects under the hood (so passing PyO3 objects is an optimization)."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Initialize the catalog interface\n# (will use the `NAUTILUS_PATH` env var as the path)\ncatalog = ParquetDataCatalog.from_env()\n\ninstrument_id = InstrumentId.from_str("TSLA.XNAS")\n\n# Decode data to pyo3 objects\nloader = DatabentoDataLoader()\ntrades = loader.from_dbn_file(\n    path=TEST_DATA_DIR / "databento" / "temp" / "tsla-xnas-20240107-20240206.trades.dbn.zst",\n    instrument_id=instrument_id,\n    as_legacy_cython=False,  # This is an optimization for writing to the catalog\n)\n\n# Write data\ncatalog.write_data(trades)\n'})}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["See also the ",(0,a.jsx)(t.a,{href:"/concepts/data",children:"Data concepts guide"}),"."]})}),"\n",(0,a.jsx)(t.h3,{id:"historical-loader-options",children:"Historical loader options"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"from_dbn_file"})," method supports several important parameters:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"instrument_id"}),": Passing this improves decode speed by skipping symbology lookup."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"price_precision"}),": Override the default price precision for the instrument."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"include_trades"}),": For MBP-1/CMBP-1 schemas, setting this to ",(0,a.jsx)(t.code,{children:"True"})," will emit both ",(0,a.jsx)(t.code,{children:"QuoteTick"})," and ",(0,a.jsx)(t.code,{children:"TradeTick"})," objects when trade data is present."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"as_legacy_cython"}),": Set to ",(0,a.jsx)(t.code,{children:"False"})," when loading IMBALANCE or STATISTICS schemas (required) or for performance when writing to catalog."]}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsxs)(t.p,{children:["IMBALANCE and STATISTICS schemas require ",(0,a.jsx)(t.code,{children:"as_legacy_cython=False"})," as these are PyO3-only types. Setting ",(0,a.jsx)(t.code,{children:"as_legacy_cython=True"})," will raise a ",(0,a.jsx)(t.code,{children:"ValueError"}),"."]})}),"\n",(0,a.jsx)(t.h3,{id:"loading-consolidated-data",children:"Loading consolidated data"}),"\n",(0,a.jsx)(t.p,{children:"Consolidated schemas aggregate data across multiple venues:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'# Load consolidated MBP-1 quotes\nloader = DatabentoDataLoader()\ncmbp_quotes = loader.from_dbn_file(\n    path="consolidated.cmbp-1.dbn.zst",\n    instrument_id=InstrumentId.from_str("AAPL.XNAS"),\n    include_trades=True,  # Get both quotes and trades if available\n    as_legacy_cython=True,\n)\n\n# Load consolidated BBO quotes\ncbbo_quotes = loader.from_dbn_file(\n    path="consolidated.cbbo-1s.dbn.zst",\n    instrument_id=InstrumentId.from_str("AAPL.XNAS"),\n    as_legacy_cython=False,  # Use PyO3 for better performance\n)\n\n# Load TCBBO (trade-sampled consolidated BBO) - provides both quotes and trades\n# Note: include_trades=True loads quotes, include_trades=False loads trades\ntcbbo_quotes = loader.from_dbn_file(\n    path="consolidated.tcbbo.dbn.zst",\n    instrument_id=InstrumentId.from_str("AAPL.XNAS"),\n    include_trades=True,  # Loads quotes\n    as_legacy_cython=True,\n)\n\ntcbbo_trades = loader.from_dbn_file(\n    path="consolidated.tcbbo.dbn.zst",\n    instrument_id=InstrumentId.from_str("AAPL.XNAS"),\n    include_trades=False,  # Loads trades\n    as_legacy_cython=True,\n)\n'})}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Cost optimization"}),": Avoid subscribing to both TBBO/TCBBO and separate trade subscriptions for the same instrument, as these schemas already include trade data. This prevents duplicates and reduces costs."]})}),"\n",(0,a.jsx)(t.h2,{id:"real-time-client-architecture",children:"Real-time client architecture"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"DatabentoDataClient"})," is a Python class which contains other Databento adapter classes.\nThere are two ",(0,a.jsx)(t.code,{children:"DatabentoLiveClient"}),"s per Databento dataset:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"One for MBO (order book deltas) real-time feeds"}),"\n",(0,a.jsx)(t.li,{children:"One for all other real-time feeds"}),"\n"]}),"\n",(0,a.jsxs)(t.admonition,{type:"warning",children:[(0,a.jsx)(t.p,{children:"There is currently a limitation that all MBO (order book deltas) subscriptions for a dataset have to be made at\nnode startup, to then be able to replay data from the beginning of the session. If subsequent subscriptions\narrive after start, then an error will be logged (and the subscription ignored)."}),(0,a.jsx)(t.p,{children:"There is no such limitation for any of the other Databento schemas."})]}),"\n",(0,a.jsxs)(t.p,{children:["A single ",(0,a.jsx)(t.code,{children:"DatabentoHistoricalClient"})," instance is reused between the ",(0,a.jsx)(t.code,{children:"DatabentoInstrumentProvider"})," and ",(0,a.jsx)(t.code,{children:"DatabentoDataClient"}),",\nwhich makes historical instrument definitions and data requests."]}),"\n",(0,a.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,a.jsxs)(t.p,{children:["The most common use case is to configure a live ",(0,a.jsx)(t.code,{children:"TradingNode"})," to include a\nDatabento data client. To achieve this, add a ",(0,a.jsx)(t.code,{children:"DATABENTO"})," section to your client\nconfiguration(s):"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from nautilus_trader.adapters.databento import DATABENTO\nfrom nautilus_trader.live.node import TradingNode\n\nconfig = TradingNodeConfig(\n    ...,  # Omitted\n    data_clients={\n        DATABENTO: {\n            "api_key": None,  # \'DATABENTO_API_KEY\' env var\n            "http_gateway": None,  # Override for the default HTTP historical gateway\n            "live_gateway": None,  # Override for the default raw TCP real-time gateway\n            "instrument_provider": InstrumentProviderConfig(load_all=True),\n            "instrument_ids": None,  # Nautilus instrument IDs to load on start\n            "parent_symbols": None,  # Databento parent symbols to load on start\n        },\n    },\n    ..., # Omitted\n)\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Then, create a ",(0,a.jsx)(t.code,{children:"TradingNode"})," and add the client factory:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"from nautilus_trader.adapters.databento.factories import DatabentoLiveDataClientFactory\nfrom nautilus_trader.live.node import TradingNode\n\n# Instantiate the live trading node with a configuration\nnode = TradingNode(config=config)\n\n# Register the client factory with the node\nnode.add_data_client_factory(DATABENTO, DatabentoLiveDataClientFactory)\n\n# Finally build the node\nnode.build()\n"})}),"\n",(0,a.jsx)(t.h3,{id:"configuration-parameters",children:"Configuration parameters"}),"\n",(0,a.jsx)(t.p,{children:"The Databento data client provides the following configuration options:"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Option"}),(0,a.jsx)(t.th,{children:"Default"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"api_key"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"None"})}),(0,a.jsxs)(t.td,{children:["Databento API secret. When ",(0,a.jsx)(t.code,{children:"None"}),", falls back to the ",(0,a.jsx)(t.code,{children:"DATABENTO_API_KEY"})," environment variable."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"http_gateway"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"None"})}),(0,a.jsx)(t.td,{children:"Historical HTTP gateway override, useful for testing custom endpoints."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"live_gateway"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"None"})}),(0,a.jsx)(t.td,{children:"Raw TCP real-time gateway override, typically only used for testing."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"use_exchange_as_venue"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"True"})}),(0,a.jsxs)(t.td,{children:["If ",(0,a.jsx)(t.code,{children:"True"}),", uses the exchange MIC for Nautilus venues (e.g., ",(0,a.jsx)(t.code,{children:"XCME"}),"). When ",(0,a.jsx)(t.code,{children:"False"}),", retains the default GLBX mapping."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"timeout_initial_load"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"15.0"})}),(0,a.jsx)(t.td,{children:"Seconds to wait for instrument definitions to load per dataset before proceeding."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"mbo_subscriptions_delay"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"3.0"})}),(0,a.jsx)(t.td,{children:"Seconds to buffer before enabling MBO/L3 streams so initial snapshots can replay in order."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"bars_timestamp_on_close"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"True"})}),(0,a.jsxs)(t.td,{children:["Timestamp bars on the close (",(0,a.jsx)(t.code,{children:"ts_event"}),"/",(0,a.jsx)(t.code,{children:"ts_init"}),"). Set ",(0,a.jsx)(t.code,{children:"False"})," to timestamp on the open."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"venue_dataset_map"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"None"})}),(0,a.jsx)(t.td,{children:"Optional mapping of Nautilus venues to Databento dataset codes."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"parent_symbols"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"None"})}),(0,a.jsxs)(t.td,{children:["Optional mapping ",(0,a.jsx)(t.code,{children:"{dataset: {parent symbols}}"})," to preload definition trees (e.g., ",(0,a.jsx)(t.code,{children:'{"GLBX.MDP3": {"ES.FUT", "ES.OPT"}}'}),")."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"instrument_ids"})}),(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"None"})}),(0,a.jsxs)(t.td,{children:["Sequence of Nautilus ",(0,a.jsx)(t.code,{children:"InstrumentId"})," values to preload definitions for at startup."]})]})]})]}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsx)(t.p,{children:"We recommend using environment variables to manage your credentials."})}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["For additional features or to contribute to the Databento adapter, please see our\n",(0,a.jsx)(t.a,{href:"https://github.com/nautechsystems/nautilus_trader/blob/develop/CONTRIBUTING.md",children:"contributing guide"}),"."]})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);
<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-integrations/okx" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">OKX | NautilusTrader 文档</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nautilus.aloen.to/integrations/okx"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="OKX | NautilusTrader 文档"><meta data-rh="true" name="description" content="OKX 成立于 2017 年，是一家领先的加密货币交易所，提供现货（spot）、永续合约（perpetual swap）、期货（futures）及期权（options）交易。本集成模块支持 OKX 的实时行情订阅（market data ingest）以及订单执行（order execution）。"><meta data-rh="true" property="og:description" content="OKX 成立于 2017 年，是一家领先的加密货币交易所，提供现货（spot）、永续合约（perpetual swap）、期货（futures）及期权（options）交易。本集成模块支持 OKX 的实时行情订阅（market data ingest）以及订单执行（order execution）。"><link data-rh="true" rel="icon" href="/logo.png"><link data-rh="true" rel="canonical" href="https://nautilus.aloen.to/integrations/okx"><link data-rh="true" rel="alternate" href="https://nautilus.aloen.to/integrations/okx" hreflang="zh"><link data-rh="true" rel="alternate" href="https://nautilus.aloen.to/integrations/okx" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"集成","item":"https://nautilus.aloen.to/integrations/"},{"@type":"ListItem","position":2,"name":"OKX","item":"https://nautilus.aloen.to/integrations/okx"}]}</script><link rel="stylesheet" href="/assets/css/styles.33db920f.css">
<script src="/assets/js/runtime~main.d37f7723.js" defer="defer"></script>
<script src="/assets/js/main.991b6fd5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/logo.png"><div role="region" aria-label="跳到主要内容"><a class="skipToContent__uWo" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo.png" alt="NautilusTrader Logo" class="themedComponent_WkLn themedComponent--light_cjoX"><img src="/logo.png" alt="NautilusTrader Logo" class="themedComponent_WkLn themedComponent--dark_jZId"></div><b class="navbar__title text--truncate">NautilusTrader</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/api_reference/">文档</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Aloento/NautilusTraderDoc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_KfBJ"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_RWFU colorModeToggle_sA1q"><button class="clean-btn toggleButton_qjfc toggleButtonDisabled_cpNp" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX lightToggleIcon_UYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX darkToggleIcon_i1s2"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX systemToggleIcon_yIQx"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_PsjF"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_jk42"><div class="docsWrapper_KWBO"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_XpKL" type="button"></button><div class="docRoot_joIP"><aside class="theme-doc-sidebar-container docSidebarContainer_DOen"><div class="sidebarViewport_j7YP"><div class="sidebar_nPgc"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_MTDt"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/api_reference/"><span title="Python API" class="categoryLinkLabel_XKxb">Python API</span></a><button aria-label="展开侧边栏分类 &#x27;Python API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/concepts/"><span title="概念" class="categoryLinkLabel_XKxb">概念</span></a><button aria-label="展开侧边栏分类 &#x27;概念&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/developer_guide/"><span title="开发者指南" class="categoryLinkLabel_XKxb">开发者指南</span></a><button aria-label="展开侧边栏分类 &#x27;开发者指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/getting_started/"><span title="入门" class="categoryLinkLabel_XKxb">入门</span></a><button aria-label="展开侧边栏分类 &#x27;入门&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist menu__link--active" href="/integrations/"><span title="集成" class="categoryLinkLabel_XKxb">集成</span></a><button aria-label="折叠侧边栏分类 &#x27;集成&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/betfair"><span title="Betfair" class="linkLabel_CNtA">Betfair</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/binance"><span title="Binance" class="linkLabel_CNtA">Binance</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/bitmex"><span title="BitMEX" class="linkLabel_CNtA">BitMEX</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/blockchain"><span title="Blockchain" class="linkLabel_CNtA">Blockchain</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/bybit"><span title="Bybit" class="linkLabel_CNtA">Bybit</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/coinbase_intx"><span title="Coinbase International" class="linkLabel_CNtA">Coinbase International</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/databento"><span title="Databento" class="linkLabel_CNtA">Databento</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/dydx"><span title="dYdX" class="linkLabel_CNtA">dYdX</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/hyperliquid"><span title="Hyperliquid" class="linkLabel_CNtA">Hyperliquid</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/ib"><span title="Interactive Brokers" class="linkLabel_CNtA">Interactive Brokers</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/integrations/okx"><span title="OKX" class="linkLabel_CNtA">OKX</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/polymarket"><span title="Polymarket" class="linkLabel_CNtA">Polymarket</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/tardis"><span title="Tardis" class="linkLabel_CNtA">Tardis</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/tutorials/"><span title="教程" class="categoryLinkLabel_XKxb">教程</span></a><button aria-label="展开侧边栏分类 &#x27;教程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_bw1l"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_PIhC"><div class="docItemContainer_pFw3"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_HRKZ" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_sX5c"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/integrations/"><span>集成</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">OKX</span></li></ul></nav><div class="tocCollapsible_DhUt theme-doc-toc-mobile tocMobile_Izjv"><button type="button" class="clean-btn tocCollapsibleButton_eYR5">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>OKX</h1></header>
<p>OKX 成立于 2017 年，是一家领先的加密货币交易所，提供现货（spot）、永续合约（perpetual swap）、期货（futures）及期权（options）交易。本集成模块支持 OKX 的实时行情订阅（market data ingest）以及订单执行（order execution）。</p>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="概览">概览<a href="#概览" class="hash-link" aria-label="概览的直接链接" title="概览的直接链接" translate="no">​</a></h2>
<p>该适配器以 Rust 实现，并提供可选的 Python 绑定，便于在以 Python 为主的工作流中使用。
无需依赖外部 OKX 客户端库——核心组件在构建时会编译为静态库并自动链接。</p>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="示例">示例<a href="#示例" class="hash-link" aria-label="示例的直接链接" title="示例的直接链接" translate="no">​</a></h2>
<p>你可以在此处找到实时的示例脚本：<a href="https://github.com/nautechsystems/nautilus_trader/tree/develop/examples/live/okx/" target="_blank" rel="noopener noreferrer">examples/live/okx</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="产品支持">产品支持<a href="#产品支持" class="hash-link" aria-label="产品支持的直接链接" title="产品支持的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>产品类型</th><th>数据流</th><th>交易</th><th>说明</th></tr></thead><tbody><tr><td>现货（Spot）</td><td>✓</td><td>✓</td><td>可用于指数类价格（index prices）。</td></tr><tr><td>永续合约（Swap）</td><td>✓</td><td>✓</td><td>支持线性（linear）与反向（inverse）合约。</td></tr><tr><td>期货（Futures）</td><td>✓</td><td>✓</td><td>有明确到期日的合约。</td></tr><tr><td>融资/保证金（Margin）</td><td>-</td><td>-</td><td><em>暂不支持。</em></td></tr><tr><td>期权（Options）</td><td>✓</td><td>-</td><td><em>仅支持行情订阅，交易接口尚在开发中。</em></td></tr></tbody></table>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p><strong>期权支持说明</strong>：当前可订阅期权市场数据并接收行情更新，但期权的下单/执行功能尚未实现。你仍可按上文的符号（symbology）格式订阅期权数据流。</p></div></div>
<p>OKX 适配器由多个组件组成，用户可根据需要单独使用或组合使用：</p>
<ul>
<li><code>OKXHttpClient</code>：HTTP REST 低层客户端。</li>
<li><code>OKXWebSocketClient</code>：WebSocket 低层客户端。</li>
<li><code>OKXInstrumentProvider</code>：合约/标的解析与加载功能。</li>
<li><code>OKXDataClient</code>：行情数据管理器（market data feed manager）。</li>
<li><code>OKXExecutionClient</code>：账户与交易执行网关（execution gateway）。</li>
<li><code>OKXLiveDataClientFactory</code>：OKX 数据客户端工厂（用于 trading node builder）。</li>
<li><code>OKXLiveExecClientFactory</code>：OKX 执行客户端工厂（用于 trading node builder）。</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_lEzE alert alert--secondary"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>备注</div><div class="admonitionContent_Vfkp"><p>大多数使用场景下，用户只需为 live trading node 定义配置（如下示例），通常无需直接与上述低层组件交互。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="符号约定symbology">符号约定（Symbology）<a href="#符号约定symbology" class="hash-link" aria-label="符号约定（Symbology）的直接链接" title="符号约定（Symbology）的直接链接" translate="no">​</a></h2>
<p>OKX 对不同品种使用特定的合约代码约定（symbol conventions）。在引用合约 ID 时，建议带上 <code>.OKX</code> 后缀（例如现货 BTC 对 USDT 应使用 <code>BTC-USDT.OKX</code>）。</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="按品种的代码格式">按品种的代码格式<a href="#按品种的代码格式" class="hash-link" aria-label="按品种的代码格式的直接链接" title="按品种的代码格式的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="现货spot">现货（SPOT）<a href="#现货spot" class="hash-link" aria-label="现货（SPOT）的直接链接" title="现货（SPOT）的直接链接" translate="no">​</a></h4>
<p>格式：<code>{BaseCurrency}-{QuoteCurrency}</code></p>
<p>示例：</p>
<ul>
<li><code>BTC-USDT</code> — 比特币对 USDT（Tether）</li>
<li><code>BTC-USDC</code> — 比特币对 USDC</li>
<li><code>ETH-USDT</code> — 以太坊对 USDT</li>
<li><code>SOL-USDT</code> — Solana 对 USDT</li>
</ul>
<p>在策略中订阅以 USD 计价的比特币现货：</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">InstrumentId</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;BTC-USDT.OKX&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># USDT 报价的现货</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InstrumentId</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;BTC-USDC.OKX&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># USDC 报价的现货</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="永续合约swap--perpetual-futures">永续合约（SWAP / Perpetual Futures）<a href="#永续合约swap--perpetual-futures" class="hash-link" aria-label="永续合约（SWAP / Perpetual Futures）的直接链接" title="永续合约（SWAP / Perpetual Futures）的直接链接" translate="no">​</a></h4>
<p>格式：<code>{BaseCurrency}-{QuoteCurrency}-SWAP</code></p>
<p>示例：</p>
<ul>
<li><code>BTC-USDT-SWAP</code> — BTC 永续合约（线性，USDT 保证金）</li>
<li><code>BTC-USD-SWAP</code> — BTC 永续合约（反向，币本位）</li>
<li><code>ETH-USDT-SWAP</code> — ETH 永续合约（线性）</li>
<li><code>ETH-USD-SWAP</code> — ETH 永续合约（反向）</li>
</ul>
<p>线性（Linear）与反向（Inverse）合约区别：</p>
<ul>
<li><strong>线性（Linear）</strong>：以 USDT 等稳定币作为保证金。</li>
<li><strong>反向（Inverse）</strong>：以基础币（如 BTC）作为保证金。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="期货futures有到期日">期货（FUTURES，有到期日）<a href="#期货futures有到期日" class="hash-link" aria-label="期货（FUTURES，有到期日）的直接链接" title="期货（FUTURES，有到期日）的直接链接" translate="no">​</a></h4>
<p>格式：<code>{BaseCurrency}-{QuoteCurrency}-{YYMMDD}</code></p>
<p>示例：</p>
<ul>
<li><code>BTC-USD-251226</code> — 2025-12-26 到期的比特币期货</li>
<li><code>ETH-USD-251226</code> — 2025-12-26 到期的以太坊期货</li>
<li><code>BTC-USD-250328</code> — 2025-03-28 到期的比特币期货</li>
</ul>
<p>注意：期货通常为反向合约（coin-margined）。</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="期权options">期权（OPTIONS）<a href="#期权options" class="hash-link" aria-label="期权（OPTIONS）的直接链接" title="期权（OPTIONS）的直接链接" translate="no">​</a></h4>
<p>格式：<code>{BaseCurrency}-{QuoteCurrency}-{YYMMDD}-{Strike}-{Type}</code></p>
<p>示例：</p>
<ul>
<li><code>BTC-USD-250328-100000-C</code> — 到期日 2025-03-28，行权价 100,000 美元的 BTC 看涨期权（Call）</li>
<li><code>BTC-USD-250328-100000-P</code> — 到期日 2025-03-28，行权价 100,000 美元的 BTC 看跌期权（Put）</li>
<li><code>ETH-USD-250328-4000-C</code> — 到期日 2025-03-28，行权价 4,000 美元的 ETH 看涨期权</li>
</ul>
<p>其中：</p>
<ul>
<li><code>C</code> 表示 Call（看涨期权）</li>
<li><code>P</code> 表示 Put（看跌期权）</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="常见问题">常见问题<a href="#常见问题" class="hash-link" aria-label="常见问题的直接链接" title="常见问题的直接链接" translate="no">​</a></h3>
<p>Q：如何订阅美元计价的比特币现货？</p>
<p>A：对 USDT 报价使用 <code>BTC-USDT.OKX</code>，对 USDC 报价使用 <code>BTC-USDC.OKX</code>。</p>
<p>Q：<code>BTC-USDT-SWAP</code> 与 <code>BTC-USD-SWAP</code> 有何区别？</p>
<p>A：<code>BTC-USDT-SWAP</code> 为线性永续（USDT 保证金）；<code>BTC-USD-SWAP</code> 为反向永续（BTC 保证金）。</p>
<p>Q：如何选择合约类型？</p>
<p>A：查看配置中的 <code>contract_types</code> 参数：</p>
<ul>
<li>线性合约（linear）：<code>OKXContractType.LINEAR</code>。</li>
<li>反向合约（inverse）：<code>OKXContractType.INVERSE</code>。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="订单能力orders-capability">订单能力（Orders capability）<a href="#订单能力orders-capability" class="hash-link" aria-label="订单能力（Orders capability）的直接链接" title="订单能力（Orders capability）的直接链接" translate="no">​</a></h2>
<p>下面列出 OKX 对线性永续（Linear Perpetual Swap）产品支持的下单类型、执行指令与时效（time-in-force）选项。</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="客户端-order-id-要求">客户端 Order ID 要求<a href="#客户端-order-id-要求" class="hash-link" aria-label="客户端 Order ID 要求的直接链接" title="客户端 Order ID 要求的直接链接" translate="no">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_lEzE alert alert--warning"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_Vfkp"><p>OKX 对客户端订单 ID（client order ID）有严格要求：</p><ul>
<li><strong>禁止使用连字符（hyphen）<code>-</code></strong>：OKX 不接受包含 <code>-</code> 的 client order ID。</li>
<li>最大长度：32 字符。</li>
<li>允许字符：仅限字母数字（alphanumeric）和下划线（underscore）。</li>
</ul><p>在配置策略时，请确保设置：</p><div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">use_hyphens_in_client_order_ids</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="订单类型">订单类型<a href="#订单类型" class="hash-link" aria-label="订单类型的直接链接" title="订单类型的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>订单类型（Order Type）</th><th>线性永续（Linear Perpetual Swap）</th><th>说明</th></tr></thead><tbody><tr><td><code>MARKET</code></td><td>✓</td><td>市价单，立即以市价成交。支持以报价数量下单（quote quantity）。</td></tr><tr><td><code>LIMIT</code></td><td>✓</td><td>限价单，在指定价格或更优价格成交。</td></tr><tr><td><code>STOP_MARKET</code></td><td>✓</td><td>条件市价单（OKX 的 algo order）。</td></tr><tr><td><code>STOP_LIMIT</code></td><td>✓</td><td>条件限价单（OKX 的 algo order）。</td></tr><tr><td><code>MARKET_IF_TOUCHED</code></td><td>✓</td><td>条件市价单（OKX 的 algo order）。</td></tr><tr><td><code>LIMIT_IF_TOUCHED</code></td><td>✓</td><td>条件限价单（OKX 的 algo order）。</td></tr><tr><td><code>TRAILING_STOP</code></td><td>-</td><td><em>暂不支持。</em></td></tr></tbody></table>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p><strong>条件单说明</strong>：<code>STOP_MARKET</code>、<code>STOP_LIMIT</code>、<code>MARKET_IF_TOUCHED</code> 与 <code>LIMIT_IF_TOUCHED</code> 通过 OKX 的 algo order 实现，支持多种触发价来源并提供更丰富的触发策略。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="执行指令execution-instructions">执行指令（Execution instructions）<a href="#执行指令execution-instructions" class="hash-link" aria-label="执行指令（Execution instructions）的直接链接" title="执行指令（Execution instructions）的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>指令（Instruction）</th><th>线性永续（Linear Perpetual Swap）</th><th>说明</th></tr></thead><tbody><tr><td><code>post_only</code></td><td>✓</td><td>仅适用于 LIMIT 单。</td></tr><tr><td><code>reduce_only</code></td><td>✓</td><td>仅适用于衍生品合约。</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="时效time-in-force">时效（Time in force）<a href="#时效time-in-force" class="hash-link" aria-label="时效（Time in force）的直接链接" title="时效（Time in force）的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>Time in force</th><th>线性永续（Linear Perpetual Swap）</th><th>说明</th></tr></thead><tbody><tr><td><code>GTC</code></td><td>✓</td><td>Good Till Canceled（直到被取消）。</td></tr><tr><td><code>FOK</code></td><td>✓</td><td>Fill or Kill（全部成交或取消）。</td></tr><tr><td><code>IOC</code></td><td>✓</td><td>Immediate or Cancel（立即成交或取消）。</td></tr><tr><td><code>GTD</code></td><td>✗</td><td><em>OKX API 不支持原生 GTD。</em></td></tr></tbody></table>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p><strong>GTD（Good Till Date）说明</strong>：OKX API 不原生支持 GTD。如果你需要按日期过期的订单，请使用 Nautilus 的策略层 GTD 功能，策略会在指定时间到期时取消对应订单以实现等价行为。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="批量操作batch-operations">批量操作（Batch operations）<a href="#批量操作batch-operations" class="hash-link" aria-label="批量操作（Batch operations）的直接链接" title="批量操作（Batch operations）的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>操作</th><th>线性永续（Linear Perpetual Swap）</th><th>说明</th></tr></thead><tbody><tr><td>批量提交（Batch Submit）</td><td>✓</td><td>单次请求提交多笔订单。</td></tr><tr><td>批量修改（Batch Modify）</td><td>✓</td><td>单次请求修改多笔订单。</td></tr><tr><td>批量撤单（Batch Cancel）</td><td>✓</td><td>单次请求撤销多笔订单。</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="持仓管理position-management">持仓管理（Position management）<a href="#持仓管理position-management" class="hash-link" aria-label="持仓管理（Position management）的直接链接" title="持仓管理（Position management）的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>功能</th><th>线性永续（Linear Perpetual Swap）</th><th>说明</th></tr></thead><tbody><tr><td>查询持仓（Query positions）</td><td>✓</td><td>实时报持仓更新。</td></tr><tr><td>持仓模式（Position mode）</td><td>✓</td><td>支持 Net 与 Long/Short 模式。</td></tr><tr><td>杠杆控制（Leverage control）</td><td>✓</td><td>支持按合约动态调整杠杆。</td></tr><tr><td>保证金模式（Margin mode）</td><td>✓</td><td>支持 cash、isolated、cross、spot_isolated 等模式。</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="保证金模式说明margin-modes">保证金模式说明（Margin modes）<a href="#保证金模式说明margin-modes" class="hash-link" aria-label="保证金模式说明（Margin modes）的直接链接" title="保证金模式说明（Margin modes）的直接链接" translate="no">​</a></h3>
<p>OKX 的统一账户系统允许在每笔订单层面选择不同的保证金模式。本适配器支持在提交订单时通过 <code>params</code> 参数指定交易模式（<code>td_mode</code>）。</p>
<div class="theme-admonition theme-admonition-note admonition_lEzE alert alert--secondary"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>备注</div><div class="admonitionContent_Vfkp"><p><strong>重要</strong>：账户的初始模式必须通过 OKX Web/App 界面配置，API 无法在首次设置时直接更改账户的模式。</p></div></div>
<p>有关 OKX 账户模式与保证金体系的详细信息，请参阅 OKX 官方文档：<a href="https://www.okx.com/docs-v5/en/#overview-account-mode" target="_blank" rel="noopener noreferrer">OKX Account Mode documentation</a>。</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="可用的保证金模式">可用的保证金模式<a href="#可用的保证金模式" class="hash-link" aria-label="可用的保证金模式的直接链接" title="可用的保证金模式的直接链接" translate="no">​</a></h4>
<ul>
<li><code>cash</code>：现货无杠杆（现货默认模式）。</li>
<li><code>isolated</code>：逐仓（isolated），风险仅限于特定仓位。</li>
<li><code>cross</code>：全仓（cross），所有仓位共享保证金池。</li>
<li><code>spot_isolated</code>：现货逐仓模式。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="在订单层面设置保证金模式">在订单层面设置保证金模式<a href="#在订单层面设置保证金模式" class="hash-link" aria-label="在订单层面设置保证金模式的直接链接" title="在订单层面设置保证金模式的直接链接" translate="no">​</a></h4>
<p>可以通过 <code>params</code> 参数为单笔订单指定保证金模式：</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 使用逐仓模式提交订单</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strategy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">submit_order</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    order</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">order</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;td_mode&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;isolated&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 使用全仓模式提交订单</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strategy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">submit_order</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    order</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">order</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;td_mode&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cross&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>如果 <code>params</code> 中未指定 <code>td_mode</code>，适配器将使用账户类型的默认模式：</p>
<ul>
<li>现金账户（Cash）默认使用 <code>cash</code>。</li>
<li>保证金账户（Margin）默认使用 <code>isolated</code>。</li>
</ul>
<p>该灵活性允许你：</p>
<ul>
<li>并行运行多个风险配置不同的策略。</li>
<li>对高风险仓位使用逐仓以隔离风险，同时对资本效率更高的仓位使用全仓。</li>
<li>在同一账户内混合现货与保证金交易。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="订单查询order-querying">订单查询（Order querying）<a href="#订单查询order-querying" class="hash-link" aria-label="订单查询（Order querying）的直接链接" title="订单查询（Order querying）的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>功能</th><th>线性永续（Linear Perpetual Swap）</th><th>说明</th></tr></thead><tbody><tr><td>查询未完成订单（open）</td><td>✓</td><td>列出所有活动订单。</td></tr><tr><td>历史订单查询（history）</td><td>✓</td><td>返回历史下单记录。</td></tr><tr><td>订单状态更新（status）</td><td>✓</td><td>实时的订单状态变化通知。</td></tr><tr><td>交易记录（trade history）</td><td>✓</td><td>包含执行与成交回报（fills）。</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="条件单contingent-orders">条件单（Contingent orders）<a href="#条件单contingent-orders" class="hash-link" aria-label="条件单（Contingent orders）的直接链接" title="条件单（Contingent orders）的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>功能</th><th>线性永续（Linear Perpetual Swap）</th><th>说明</th></tr></thead><tbody><tr><td>订单列表（Order lists）</td><td>-</td><td><em>不支持</em></td></tr><tr><td>OCO 订单（OCO orders）</td><td>✓</td><td>One-Cancels-Other（互斥）订单。</td></tr><tr><td>括号单（Bracket orders）</td><td>✓</td><td>止损 + 止盈 的组合单。</td></tr><tr><td>条件单（Conditional）</td><td>✓</td><td>包含 Stop 与 Limit-if-touched 等。</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="条件单架构">条件单架构<a href="#条件单架构" class="hash-link" aria-label="条件单架构的直接链接" title="条件单架构的直接链接" translate="no">​</a></h4>
<p>条件单（OKX 的 algo orders）采用混合架构以兼顾性能与可靠性：</p>
<ul>
<li><strong>提交</strong>：通过 HTTP REST API（<code>/api/v5/trade/order-algo</code>）。</li>
<li><strong>状态更新</strong>：通过 WebSocket 的 business 端点（<code>/ws/v5/business</code>）上的 <code>orders-algo</code> 频道推送。</li>
<li><strong>取消</strong>：通过 HTTP REST API 并使用 algo order ID 进行跟踪与管理。</li>
</ul>
<p>该设计保证了：</p>
<ul>
<li>通过 HTTP 可即时收到提交确认。</li>
<li>通过 WebSocket 获取实时状态更新。</li>
<li>使用 algo order ID 实现完整的订单生命周期管理。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="支持的条件单类型">支持的条件单类型<a href="#支持的条件单类型" class="hash-link" aria-label="支持的条件单类型的直接链接" title="支持的条件单类型的直接链接" translate="no">​</a></h4>
<table><thead><tr><th>订单类型（Order Type）</th><th>触发价类型（Trigger Types）</th><th>说明</th></tr></thead><tbody><tr><td><code>STOP_MARKET</code></td><td>Last, Mark, Index</td><td>触发后按市价执行。</td></tr><tr><td><code>STOP_LIMIT</code></td><td>Last, Mark, Index</td><td>触发后提交限价单。</td></tr><tr><td><code>MARKET_IF_TOUCHED</code></td><td>Last, Mark, Index</td><td>触发后按市价执行。</td></tr><tr><td><code>LIMIT_IF_TOUCHED</code></td><td>Last, Mark, Index</td><td>触发后提交限价单。</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="触发价来源trigger-price-types">触发价来源（Trigger price types）<a href="#触发价来源trigger-price-types" class="hash-link" aria-label="触发价来源（Trigger price types）的直接链接" title="触发价来源（Trigger price types）的直接链接" translate="no">​</a></h4>
<p>条件单支持多种触发价来源：</p>
<ul>
<li><strong>Last Price</strong>（<code>TriggerType.LAST_PRICE</code>）：使用最新成交价（默认）。</li>
<li><strong>Mark Price</strong>（<code>TriggerType.MARK_PRICE</code>）：使用标记价（推荐用于衍生品）。</li>
<li><strong>Index Price</strong>（<code>TriggerType.INDEX_PRICE</code>）：使用基础指数价格。</li>
</ul>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 示例：使用 mark price 作为触发价的止损单</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stop_order </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> order_factory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stop_market</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    instrument_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">instrument_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    order_side</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">OrderSide</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SELL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quantity</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Quantity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;0.1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    trigger_price</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Price</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;45000.0&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    trigger_type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">TriggerType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MARK_PRICE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 使用标记价作为触发价</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strategy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">submit_order</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stop_order</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="认证authentication">认证（Authentication）<a href="#认证authentication" class="hash-link" aria-label="认证（Authentication）的直接链接" title="认证（Authentication）的直接链接" translate="no">​</a></h2>
<p>使用 OKX 适配器前，你需要在 OKX 账户中创建 API 凭证：</p>
<ol>
<li>登录 OKX，进入 API 管理页面。</li>
<li>创建一个具备交易与行情访问权限的 API key。</li>
<li>记录下 API key、secret key 与 passphrase。</li>
</ol>
<p>可以通过环境变量提供这些凭证：</p>
<div class="language-bash codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-bash codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">export OKX_API_KEY=&quot;your_api_key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export OKX_API_SECRET=&quot;your_api_secret&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export OKX_API_PASSPHRASE=&quot;your_passphrase&quot;</span><br></span></code></pre></div></div>
<p>也可以直接在配置中传入（但不推荐在生产环境中这样做）。</p>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="模拟交易demo-trading">模拟交易（Demo trading）<a href="#模拟交易demo-trading" class="hash-link" aria-label="模拟交易（Demo trading）的直接链接" title="模拟交易（Demo trading）的直接链接" translate="no">​</a></h2>
<p>OKX 提供了模拟（demo）交易环境，便于在不动用真实资金的情况下测试策略。要启用 demo 模式，在客户端配置中将 <code>is_demo=True</code>：</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TradingNodeConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_clients</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OKX</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> OKXDataClientConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is_demo</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 启用 demo 模式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># ... 其他配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec_clients</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OKX</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> OKXExecClientConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is_demo</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 启用 demo 模式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># ... 其他配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>启用 demo 模式时：</p>
<ul>
<li>REST 请求会带上 <code>x-simulated-trading: 1</code> 的 header。</li>
<li>WebSocket 使用 demo 专用的 endpoint（例如 <code>wspap.okx.com</code>）。</li>
<li>使用的 API 凭证与生产环境相同，但必须为 demo 专用的 API key（生产 key 无法在 demo 模式下使用）。</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_lEzE alert alert--secondary"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>备注</div><div class="admonitionContent_Vfkp"><p>请务必使用为 demo 交易单独创建的 API key，生产环境的 API key 无法用于 demo 模式。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="速率限制rate-limiting">速率限制（Rate limiting）<a href="#速率限制rate-limiting" class="hash-link" aria-label="速率限制（Rate limiting）的直接链接" title="速率限制（Rate limiting）的直接链接" translate="no">​</a></h2>
<p>适配器会在客户端层面遵守 OKX 的 endpoint 限额设置，同时为 REST 与 WebSocket 调用提供合理的默认值。</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="rest-限额">REST 限额<a href="#rest-限额" class="hash-link" aria-label="REST 限额的直接链接" title="REST 限额的直接链接" translate="no">​</a></h3>
<ul>
<li>全局上限（Global cap）：250 次请求 / 秒（对应 OKX 的 500 次请求 / 2 秒的 IP 限额）。</li>
<li>下表列出了针对常用 endpoint 的较为保守的配额，参考 OKX 官方发布的限制。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="websocket-限额">WebSocket 限额<a href="#websocket-限额" class="hash-link" aria-label="WebSocket 限额的直接链接" title="WebSocket 限额的直接链接" translate="no">​</a></h3>
<ul>
<li>订阅操作（subscription）：3 次请求 / 秒。</li>
<li>订单相关操作（下单/撤单/修改）：250 次请求 / 秒。</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_lEzE alert alert--warning"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_Vfkp"><p>OKX 对每个 endpoint 与每个账户均实施限额；超出速率会导致 HTTP 429 返回并暂时对该 API key 进行限流。</p></div></div>
<table><thead><tr><th>Key / Endpoint</th><th>限额（次/秒）</th><th>说明</th></tr></thead><tbody><tr><td><code>okx:global</code></td><td>250</td><td>对应 500 req / 2 s 的 IP 限额。</td></tr><tr><td><code>/api/v5/public/instruments</code></td><td>10</td><td>与 OKX 文档中 20 req / 2 s 的限制相匹配。</td></tr><tr><td><code>/api/v5/market/candles</code></td><td>50</td><td>用于流式 candles 的较高配额。</td></tr><tr><td><code>/api/v5/market/history-candles</code></td><td>20</td><td>用于大规模历史数据拉取的保守配额。</td></tr><tr><td><code>/api/v5/market/history-trades</code></td><td>30</td><td>交易历史查询。</td></tr><tr><td><code>/api/v5/account/balance</code></td><td>5</td><td>OKX 建议值：10 req / 2 s。</td></tr><tr><td><code>/api/v5/trade/order</code></td><td>30</td><td>每合约 60 req / 2 s 的限制对应的保守设置。</td></tr><tr><td><code>/api/v5/trade/orders-pending</code></td><td>20</td><td>未成交订单查询。</td></tr><tr><td><code>/api/v5/trade/orders-history</code></td><td>20</td><td>订单历史查询。</td></tr><tr><td><code>/api/v5/trade/fills</code></td><td>30</td><td>成交回报查询（fills）。</td></tr><tr><td><code>/api/v5/trade/order-algo</code></td><td>10</td><td>条件单（algo order）提交。</td></tr><tr><td><code>/api/v5/trade/cancel-algos</code></td><td>10</td><td>条件单取消接口。</td></tr></tbody></table>
<p>所有 key 默认都包含 <code>okx:global</code> 桶（bucket）。在限流前会对 URL 做归一化处理（移除 query string），因此带不同过滤参数的请求也会共享同一配额。</p>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p>更多关于速率限制的细节，请参阅官方文档：<a href="https://www.okx.com/docs-v5/en/#rest-api-rate-limit" target="_blank" rel="noopener noreferrer">OKX REST API Rate Limit</a>。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="配置configuration">配置（Configuration）<a href="#配置configuration" class="hash-link" aria-label="配置（Configuration）的直接链接" title="配置（Configuration）的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="配置选项">配置选项<a href="#配置选项" class="hash-link" aria-label="配置选项的直接链接" title="配置选项的直接链接" translate="no">​</a></h3>
<p>OKX 数据客户端提供如下可配置项：</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="数据客户端data-client">数据客户端（Data client）<a href="#数据客户端data-client" class="hash-link" aria-label="数据客户端（Data client）的直接链接" title="数据客户端（Data client）的直接链接" translate="no">​</a></h4>
<table><thead><tr><th>选项（Option）</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td><code>instrument_types</code></td><td><code>(OKXInstrumentType.SPOT,)</code></td><td>控制加载哪些 OKX 的品种族（spot、swap、futures、options）。</td></tr><tr><td><code>contract_types</code></td><td><code>None</code></td><td>与 <code>instrument_types</code> 配合使用以限制加载特定的合约风格（如 linear/inverse）。</td></tr><tr><td><code>base_url_http</code></td><td><code>None</code></td><td>覆盖 OKX REST endpoint；默认在运行时解析为生产 URL。</td></tr><tr><td><code>base_url_ws</code></td><td><code>None</code></td><td>覆盖行情 WebSocket 的 endpoint。</td></tr><tr><td><code>api_key</code> / <code>api_secret</code> / <code>api_passphrase</code></td><td><code>None</code></td><td>为空时会从环境变量 <code>OKX_API_KEY</code>、<code>OKX_API_SECRET</code>、<code>OKX_PASSPHRASE</code> 中读取。</td></tr><tr><td><code>is_demo</code></td><td><code>False</code></td><td>设为 <code>True</code> 则连接 OKX 的 demo 环境。</td></tr><tr><td><code>http_timeout_secs</code></td><td><code>60</code></td><td>REST 行情请求的超时时间（秒）。</td></tr><tr><td><code>update_instruments_interval_mins</code></td><td><code>60</code></td><td>后台刷新 instruments 的时间间隔（分钟）。</td></tr><tr><td><code>vip_level</code></td><td><code>None</code></td><td>设置为匹配的 OKX VIP 等级后可启用更高深度的订单簿频道。</td></tr></tbody></table>
<p>OKX 的执行客户端（execution client）提供如下配置项：</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="执行客户端execution-client">执行客户端（Execution client）<a href="#执行客户端execution-client" class="hash-link" aria-label="执行客户端（Execution client）的直接链接" title="执行客户端（Execution client）的直接链接" translate="no">​</a></h4>
<table><thead><tr><th>选项（Option）</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td><code>instrument_types</code></td><td><code>(OKXInstrumentType.SPOT,)</code></td><td>该执行客户端可交易的品种族。</td></tr><tr><td><code>contract_types</code></td><td><code>None</code></td><td>与 <code>instrument_types</code> 配合使用以限制可交易的合约（linear、inverse、options）。</td></tr><tr><td><code>base_url_http</code></td><td><code>None</code></td><td>覆盖交易 REST endpoint。</td></tr><tr><td><code>base_url_ws</code></td><td><code>None</code></td><td>覆盖私有 WebSocket 的 endpoint。</td></tr><tr><td><code>api_key</code> / <code>api_secret</code> / <code>api_passphrase</code></td><td><code>None</code></td><td>为空时回退到 <code>OKX_API_KEY</code>、<code>OKX_API_SECRET</code>、<code>OKX_PASSPHRASE</code> 环境变量。</td></tr><tr><td><code>margin_mode</code></td><td><code>None</code></td><td>在指定时强制 OKX 账户使用某一保证金模式（cross 或 isolated）。</td></tr><tr><td><code>is_demo</code></td><td><code>False</code></td><td>连接 OKX 的 demo 交易环境。</td></tr><tr><td><code>http_timeout_secs</code></td><td><code>60</code></td><td>REST 交易请求的超时时间（秒）。</td></tr><tr><td><code>use_fills_channel</code></td><td><code>False</code></td><td>是否订阅专用的 fills 频道（需 VIP5+）以获得更低延迟的成交回报。</td></tr><tr><td><code>use_mm_mass_cancel</code></td><td><code>False</code></td><td>是否使用做市商的批量撤单接口；不可用时回退到单笔撤单。</td></tr><tr><td><code>max_retries</code></td><td><code>3</code></td><td>可恢复性 REST 错误的最大重试次数。</td></tr><tr><td><code>retry_delay_initial_ms</code></td><td><code>1,000</code></td><td>在重试失败请求前使用的初始延迟（毫秒）。</td></tr><tr><td><code>retry_delay_max_ms</code></td><td><code>10,000</code></td><td>指数退避重试时的上限延迟（毫秒）。</td></tr></tbody></table>
<p>下面示例展示了如何在 live trading node 中配置 OKX 的数据与执行客户端：</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">adapters</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okx </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> OKX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">adapters</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okx </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> OKXDataClientConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OKXExecClientConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">adapters</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">factories </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> OKXLiveDataClientFactory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OKXLiveExecClientFactory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">config </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> InstrumentProviderConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LiveExecEngineConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LoggingConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TradingNodeConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nautilus_pyo3 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> OKXContractType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nautilus_pyo3 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> OKXInstrumentType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">live</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">node </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> TradingNode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TradingNodeConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_clients</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OKX</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> OKXDataClientConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            api_key</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># Will use OKX_API_KEY env var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            api_secret</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Will use OKX_API_SECRET env var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            api_passphrase</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Will use OKX_API_PASSPHRASE env var</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            base_url_http</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            instrument_provider</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">InstrumentProviderConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">load_all</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            instrument_types</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OKXInstrumentType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SWAP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            contract_types</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OKXContractType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LINEAR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is_demo</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec_clients</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        OKX</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> OKXExecClientConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            api_key</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            api_secret</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            api_passphrase</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            base_url_http</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            base_url_ws</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            instrument_provider</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">InstrumentProviderConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">load_all</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            instrument_types</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OKXInstrumentType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SWAP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            contract_types</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OKXContractType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LINEAR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is_demo</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TradingNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_data_client_factory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OKX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OKXLiveDataClientFactory</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_exec_client_factory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OKX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OKXLiveExecClientFactory</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p>如需更多功能或参与 OKX 适配器的贡献，请参阅我们的贡献指南：<a href="https://github.com/nautechsystems/nautilus_trader/blob/develop/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">contributing guide</a>。</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Aloento/NautilusTraderDoc/tree/main/docs/integrations/okx.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_F7ru" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_GNoA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/integrations/ib"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Interactive Brokers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/integrations/polymarket"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Polymarket</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_pg_n thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概览" class="table-of-contents__link toc-highlight">概览</a></li><li><a href="#示例" class="table-of-contents__link toc-highlight">示例</a><ul><li><a href="#产品支持" class="table-of-contents__link toc-highlight">产品支持</a></li></ul></li><li><a href="#符号约定symbology" class="table-of-contents__link toc-highlight">符号约定（Symbology）</a><ul><li><a href="#按品种的代码格式" class="table-of-contents__link toc-highlight">按品种的代码格式</a></li><li><a href="#常见问题" class="table-of-contents__link toc-highlight">常见问题</a></li></ul></li><li><a href="#订单能力orders-capability" class="table-of-contents__link toc-highlight">订单能力（Orders capability）</a><ul><li><a href="#客户端-order-id-要求" class="table-of-contents__link toc-highlight">客户端 Order ID 要求</a></li><li><a href="#订单类型" class="table-of-contents__link toc-highlight">订单类型</a></li><li><a href="#执行指令execution-instructions" class="table-of-contents__link toc-highlight">执行指令（Execution instructions）</a></li><li><a href="#时效time-in-force" class="table-of-contents__link toc-highlight">时效（Time in force）</a></li><li><a href="#批量操作batch-operations" class="table-of-contents__link toc-highlight">批量操作（Batch operations）</a></li><li><a href="#持仓管理position-management" class="table-of-contents__link toc-highlight">持仓管理（Position management）</a></li><li><a href="#保证金模式说明margin-modes" class="table-of-contents__link toc-highlight">保证金模式说明（Margin modes）</a></li><li><a href="#订单查询order-querying" class="table-of-contents__link toc-highlight">订单查询（Order querying）</a></li><li><a href="#条件单contingent-orders" class="table-of-contents__link toc-highlight">条件单（Contingent orders）</a></li></ul></li><li><a href="#认证authentication" class="table-of-contents__link toc-highlight">认证（Authentication）</a></li><li><a href="#模拟交易demo-trading" class="table-of-contents__link toc-highlight">模拟交易（Demo trading）</a></li><li><a href="#速率限制rate-limiting" class="table-of-contents__link toc-highlight">速率限制（Rate limiting）</a><ul><li><a href="#rest-限额" class="table-of-contents__link toc-highlight">REST 限额</a></li><li><a href="#websocket-限额" class="table-of-contents__link toc-highlight">WebSocket 限额</a></li></ul></li><li><a href="#配置configuration" class="table-of-contents__link toc-highlight">配置（Configuration）</a><ul><li><a href="#配置选项" class="table-of-contents__link toc-highlight">配置选项</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/nautechsystems/nautilus_trader" target="_blank" rel="noopener noreferrer" class="footer__link-item">Official GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_KfBJ"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://nautilustrader.io/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Official Documentation<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_KfBJ"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 Nautech Systems Pty Ltd. All rights reserved.</div></div></div></footer></div>
</body>
</html>
<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-concepts/logging" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Logging | NautilusTrader 文档</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nautilus.aloen.to/concepts/logging"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Logging | NautilusTrader 文档"><meta data-rh="true" name="description" content="The platform provides logging for both backtesting and live trading using a high-performance logging subsystem implemented in Rust"><meta data-rh="true" property="og:description" content="The platform provides logging for both backtesting and live trading using a high-performance logging subsystem implemented in Rust"><link data-rh="true" rel="icon" href="/logo.png"><link data-rh="true" rel="canonical" href="https://nautilus.aloen.to/concepts/logging"><link data-rh="true" rel="alternate" href="https://nautilus.aloen.to/concepts/logging" hreflang="zh"><link data-rh="true" rel="alternate" href="https://nautilus.aloen.to/concepts/logging" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Concepts","item":"https://nautilus.aloen.to/concepts/"},{"@type":"ListItem","position":2,"name":"Logging","item":"https://nautilus.aloen.to/concepts/logging"}]}</script><link rel="stylesheet" href="/assets/css/styles.33db920f.css">
<script src="/assets/js/runtime~main.eefcc7db.js" defer="defer"></script>
<script src="/assets/js/main.3352860b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/logo.png"><div role="region" aria-label="跳到主要内容"><a class="skipToContent__uWo" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo.png" alt="NautilusTrader Logo" class="themedComponent_WkLn themedComponent--light_cjoX"><img src="/logo.png" alt="NautilusTrader Logo" class="themedComponent_WkLn themedComponent--dark_jZId"></div><b class="navbar__title text--truncate">NautilusTrader</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/api_reference/">文档</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Aloento/NautilusTraderDoc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_KfBJ"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_RWFU colorModeToggle_sA1q"><button class="clean-btn toggleButton_qjfc toggleButtonDisabled_cpNp" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX lightToggleIcon_UYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX darkToggleIcon_i1s2"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX systemToggleIcon_yIQx"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_PsjF"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_jk42"><div class="docsWrapper_KWBO"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_XpKL" type="button"></button><div class="docRoot_joIP"><aside class="theme-doc-sidebar-container docSidebarContainer_DOen"><div class="sidebarViewport_j7YP"><div class="sidebar_nPgc"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_MTDt"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/api_reference/"><span title="Python API" class="categoryLinkLabel_XKxb">Python API</span></a><button aria-label="展开侧边栏分类 &#x27;Python API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist menu__link--active" href="/concepts/"><span title="Concepts" class="categoryLinkLabel_XKxb">Concepts</span></a><button aria-label="折叠侧边栏分类 &#x27;Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/actors"><span title="Actors" class="linkLabel_CNtA">Actors</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/adapters"><span title="Adapters" class="linkLabel_CNtA">Adapters</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/architecture"><span title="Architecture" class="linkLabel_CNtA">Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/backtesting"><span title="Backtesting" class="linkLabel_CNtA">Backtesting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/cache"><span title="Cache" class="linkLabel_CNtA">Cache</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/data"><span title="Data" class="linkLabel_CNtA">Data</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/execution"><span title="Execution" class="linkLabel_CNtA">Execution</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/instruments"><span title="Instruments" class="linkLabel_CNtA">Instruments</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/live"><span title="Live Trading" class="linkLabel_CNtA">Live Trading</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/concepts/logging"><span title="Logging" class="linkLabel_CNtA">Logging</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/message_bus"><span title="Message Bus" class="linkLabel_CNtA">Message Bus</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/orders"><span title="Orders" class="linkLabel_CNtA">Orders</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/overview"><span title="Overview" class="linkLabel_CNtA">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/portfolio"><span title="Portfolio" class="linkLabel_CNtA">Portfolio</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/positions"><span title="Positions" class="linkLabel_CNtA">Positions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/reports"><span title="Reports" class="linkLabel_CNtA">Reports</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/strategies"><span title="Strategies" class="linkLabel_CNtA">Strategies</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/developer_guide/"><span title="Developer Guide" class="categoryLinkLabel_XKxb">Developer Guide</span></a><button aria-label="展开侧边栏分类 &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/getting_started/"><span title="入门" class="categoryLinkLabel_XKxb">入门</span></a><button aria-label="展开侧边栏分类 &#x27;入门&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/integrations/"><span title="Integrations" class="categoryLinkLabel_XKxb">Integrations</span></a><button aria-label="展开侧边栏分类 &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/tutorials/"><span title="教程" class="categoryLinkLabel_XKxb">教程</span></a><button aria-label="展开侧边栏分类 &#x27;教程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_bw1l"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_PIhC"><div class="docItemContainer_pFw3"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_HRKZ" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_sX5c"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/concepts/"><span>Concepts</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Logging</span></li></ul></nav><div class="tocCollapsible_DhUt theme-doc-toc-mobile tocMobile_Izjv"><button type="button" class="clean-btn tocCollapsibleButton_eYR5">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Logging</h1></header>
<p>The platform provides logging for both backtesting and live trading using a high-performance logging subsystem implemented in Rust
with a standardized facade from the <code>log</code> crate.</p>
<p>The core logger operates in a separate thread and uses a multi-producer single-consumer (MPSC) channel to receive log messages.
This design ensures that the main thread remains performant, avoiding potential bottlenecks caused by log string formatting or file I/O operations.</p>
<p>Logging output is configurable and supports:</p>
<ul>
<li><strong>stdout/stderr writer</strong> for console output</li>
<li><strong>file writer</strong> for persistent storage of logs</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p>Infrastructure such as <a href="https://github.com/vectordotdev/vector" target="_blank" rel="noopener noreferrer">Vector</a> can be integrated to collect and aggregate events within your system.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Configuration的直接链接" title="Configuration的直接链接" translate="no">​</a></h2>
<p>Logging can be configured by importing the <code>LoggingConfig</code> object.
By default, log events with an &#x27;INFO&#x27; <code>LogLevel</code> and higher are written to stdout/stderr.</p>
<p>Log level (<code>LogLevel</code>) values include (and generally match Rust&#x27;s <code>tracing</code> level filters).</p>
<p>Python loggers expose the following levels:</p>
<ul>
<li><code>OFF</code></li>
<li><code>TRACE</code> (can be set as a filter level, but not directly generated from Python)</li>
<li><code>DEBUG</code></li>
<li><code>INFO</code></li>
<li><code>WARNING</code></li>
<li><code>ERROR</code></li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_lEzE alert alert--warning"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_Vfkp"><p>The Python <code>Logger</code> does not provide a <code>trace()</code> method; <code>TRACE</code> level logs are only emitted by the underlying Rust components and cannot be generated directly from Python code. However, you can set <code>TRACE</code> as a logging level filter to see trace logs from Rust components.</p><p>See the <code>LoggingConfig</code> <a href="/api_reference/config#class-loggingconfig">API Reference</a> for further details.</p></div></div>
<p>Logging can be configured in the following ways:</p>
<ul>
<li>Minimum <code>LogLevel</code> for stdout/stderr.</li>
<li>Minimum <code>LogLevel</code> for log files.</li>
<li>Maximum size before rotating a log file.</li>
<li>Maximum number of backup log files to maintain when rotating.</li>
<li>Automatic log file naming with date or timestamp components, or custom log file name.</li>
<li>Directory for writing log files.</li>
<li>Plain text or JSON log file formatting.</li>
<li>Filtering of individual components by log level.</li>
<li>ANSI colors in log lines.</li>
<li>Bypass logging entirely.</li>
<li>Print Rust config to stdout at initialization.</li>
<li>Optionally initialize logging via the PyO3 bridge (<code>use_pyo3</code>) to capture log events emitted by Rust components.</li>
<li>Truncate existing log file on startup if it already exists (<code>clear_log_file</code>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="standard-output-logging">Standard output logging<a href="#standard-output-logging" class="hash-link" aria-label="Standard output logging的直接链接" title="Standard output logging的直接链接" translate="no">​</a></h3>
<p>Log messages are written to the console via stdout/stderr writers. The minimum log level can be configured using the <code>log_level</code> parameter.</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="file-logging">File logging<a href="#file-logging" class="hash-link" aria-label="File logging的直接链接" title="File logging的直接链接" translate="no">​</a></h3>
<p>Log files are written to the current working directory by default. The naming convention and rotation behavior are configurable and follow specific patterns based on your settings.</p>
<p>You can specify a custom log directory using <code>log_directory</code> and/or a custom file basename using <code>log_file_name</code>. Log files are always suffixed with <code>.log</code> (plain text) or <code>.json</code> (JSON).</p>
<p>For detailed information about log file naming conventions and rotation behavior, see the <a href="#log-file-rotation">Log file rotation</a> and <a href="#log-file-naming-convention">Log file naming convention</a> sections below.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="log-file-rotation">Log file rotation<a href="#log-file-rotation" class="hash-link" aria-label="Log file rotation的直接链接" title="Log file rotation的直接链接" translate="no">​</a></h4>
<p>Rotation behavior depends on both the presence of a size limit and whether a custom file name is provided:</p>
<ul>
<li><strong>Size-based rotation</strong>:<!-- -->
<ul>
<li>Enabled by specifying the <code>log_file_max_size</code> parameter (e.g., <code>100_000_000</code> for 100 MB).</li>
<li>When writing a log entry would make the current file exceed this size, the file is closed and a new one is created.</li>
</ul>
</li>
<li><strong>Date-based rotation (default naming only)</strong>:<!-- -->
<ul>
<li>Applies when no <code>log_file_max_size</code> is specified and no custom <code>log_file_name</code> is provided.</li>
<li>At each UTC date change (midnight), the current log file is closed and a new one is started, creating one file per UTC day.</li>
</ul>
</li>
<li><strong>No rotation</strong>:<!-- -->
<ul>
<li>When a custom <code>log_file_name</code> is provided without a <code>log_file_max_size</code>, logs continue to append to the same file.</li>
</ul>
</li>
<li><strong>Backup file management</strong>:<!-- -->
<ul>
<li>Controlled by the <code>log_file_max_backup_count</code> parameter (default: 5), limiting the total number of rotated files kept.</li>
<li>When this limit is exceeded, the oldest backup files are automatically removed.</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="log-file-naming-convention">Log file naming convention<a href="#log-file-naming-convention" class="hash-link" aria-label="Log file naming convention的直接链接" title="Log file naming convention的直接链接" translate="no">​</a></h4>
<p>The default naming convention ensures log files are uniquely identifiable and timestamped.
The format depends on whether file rotation is enabled:</p>
<p><strong>With file rotation enabled</strong>:</p>
<ul>
<li><strong>Format</strong>: <code>{trader_id}_{%Y-%m-%d_%H%M%S:%3f}_{instance_id}.{log|json}</code></li>
<li><strong>Example</strong>: <code>TESTER-001_2025-04-09_210721:521_d7dc12c8-7008-4042-8ac4-017c3db0fc38.log</code></li>
<li><strong>Components</strong>:<!-- -->
<ul>
<li><code>{trader_id}</code>: The trader identifier (e.g., <code>TESTER-001</code>).</li>
<li><code>{%Y-%m-%d_%H%M%S:%3f}</code>: Full ISO 8601-compliant datetime with millisecond resolution.</li>
<li><code>{instance_id}</code>: A unique instance identifier.</li>
<li><code>{log|json}</code>: File suffix based on format setting.</li>
</ul>
</li>
</ul>
<p><strong>Without size-based rotation (default naming)</strong>:</p>
<ul>
<li><strong>Format</strong>: <code>{trader_id}_{%Y-%m-%d}_{instance_id}.{log|json}</code></li>
<li><strong>Example</strong>: <code>TESTER-001_2025-04-09_d7dc12c8-7008-4042-8ac4-017c3db0fc38.log</code></li>
<li><strong>Components</strong>:<!-- -->
<ul>
<li><code>{trader_id}</code>: The trader identifier.</li>
<li><code>{%Y-%m-%d}</code>: Date only (YYYY-MM-DD).</li>
<li><code>{instance_id}</code>: A unique instance identifier.</li>
<li><code>{log|json}</code>: File suffix based on format setting.</li>
</ul>
</li>
<li><strong>Note</strong>: With default naming and no size limit, logs rotate daily at UTC midnight.</li>
</ul>
<p><strong>Custom naming</strong>:</p>
<p>If <code>log_file_name</code> is set (e.g., <code>my_custom_log</code>):</p>
<ul>
<li>With rotation disabled: The file will be named exactly as provided (e.g., <code>my_custom_log.log</code>).</li>
<li>With rotation enabled: The file will include the custom name and timestamp (e.g., <code>my_custom_log_2025-04-09_210721:521.log</code>).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="component-log-filtering">Component log filtering<a href="#component-log-filtering" class="hash-link" aria-label="Component log filtering的直接链接" title="Component log filtering的直接链接" translate="no">​</a></h3>
<p>The <code>log_component_levels</code> parameter can be used to set log levels for each component individually.
The input value should be a dictionary of component ID strings to log level strings: <code>dict[str, str]</code>.</p>
<p>Below is an example of a trading node logging configuration that includes some of the options mentioned above:</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">config </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> LoggingConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">config </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> TradingNodeConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config_node </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TradingNodeConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    trader_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;TESTER-001&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logging</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LoggingConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_level</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;INFO&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_level_file</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;DEBUG&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_file_format</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_component_levels</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Portfolio&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;INFO&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Omitted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>For backtesting, the <code>BacktestEngineConfig</code> class can be used instead of <code>TradingNodeConfig</code>, as the same options are available.</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="components-only-logging">Components-only logging<a href="#components-only-logging" class="hash-link" aria-label="Components-only logging的直接链接" title="Components-only logging的直接链接" translate="no">​</a></h3>
<p>When focusing on a subset of noisy systems, enable <code>log_components_only</code> to log messages only from components explicitly listed in <code>log_component_levels</code>. All other components are suppressed regardless of the global <code>log_level</code> or file level.</p>
<p>Example (Python configuration):</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">logging </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LoggingConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_level</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;INFO&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_component_levels</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;RiskEngine&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DEBUG&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;Portfolio&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;INFO&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_components_only</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>If configuring via the environment using the Rust spec string, include <code>log_components_only</code> alongside component filters, for example:</p>
<div class="language-bash codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-bash codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">export NAUTILUS_LOG=&quot;stdout=Info;log_components_only;RiskEngine=Debug;Portfolio=Info&quot;</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_lEzE alert alert--warning"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_Vfkp"><p>If <code>log_components_only=True</code> (or <code>log_components_only</code> is present in the spec string) and <code>log_component_levels</code> is empty, no log messages will be emitted to stdout/stderr or files. Add at least one component filter or disable components-only logging.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="log-colors">Log Colors<a href="#log-colors" class="hash-link" aria-label="Log Colors的直接链接" title="Log Colors的直接链接" translate="no">​</a></h3>
<p>ANSI color codes are utilized to enhance the readability of logs when viewed in a terminal.
These color codes can make it easier to distinguish different parts of log messages.
In environments that do not support ANSI color rendering (such as some cloud environments or text editors),
these color codes may not be appropriate as they can appear as raw text.</p>
<p>To accommodate for such scenarios, the <code>LoggingConfig.log_colors</code> option can be set to <code>false</code>.
Disabling <code>log_colors</code> will prevent the addition of ANSI color codes to the log messages, ensuring
compatibility across different environments where color rendering is not supported.</p>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="using-a-logger-directly">Using a logger directly<a href="#using-a-logger-directly" class="hash-link" aria-label="Using a logger directly的直接链接" title="Using a logger directly的直接链接" translate="no">​</a></h2>
<p>It&#x27;s possible to use <code>Logger</code> objects directly, and these can be initialized anywhere (very similar to the Python built-in <code>logging</code> API).</p>
<p>If you <em><strong>aren&#x27;t</strong></em> using an object which already initializes a <code>NautilusKernel</code> (and logging) such as <code>BacktestEngine</code> or <code>TradingNode</code>,
then you can activate logging in the following way:</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">component </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> init_logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">component </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Logger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_guard </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> init_logging</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logger </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Logger</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MyLogger&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p>See the <code>init_logging</code> <a href="/api_reference/common">API Reference</a> for further details.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_lEzE alert alert--warning"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_Vfkp"><p>Only one logging subsystem can be initialized per process with an <code>init_logging</code> call. Multiple <code>LogGuard</code> instances (up to 255) can exist concurrently, and the logging thread will remain active until all guards are dropped.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="logguard-managing-log-lifecycle">LogGuard: managing log lifecycle<a href="#logguard-managing-log-lifecycle" class="hash-link" aria-label="LogGuard: managing log lifecycle的直接链接" title="LogGuard: managing log lifecycle的直接链接" translate="no">​</a></h2>
<p>The <code>LogGuard</code> ensures that the logging subsystem remains active and operational throughout the lifecycle of a process.
It prevents premature shutdown of the logging subsystem when running multiple engines in the same process.</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="reference-counting-implementation">Reference Counting Implementation<a href="#reference-counting-implementation" class="hash-link" aria-label="Reference Counting Implementation的直接链接" title="Reference Counting Implementation的直接链接" translate="no">​</a></h3>
<p>The logging system uses reference counting to track active <code>LogGuard</code> instances:</p>
<ul>
<li><strong>Counter increments</strong>: When a new <code>LogGuard</code> is created, an atomic counter is incremented.</li>
<li><strong>Counter decrements</strong>: When a <code>LogGuard</code> is dropped, the counter is decremented.</li>
<li><strong>Logging thread termination</strong>: When the counter reaches zero (last <code>LogGuard</code> dropped), the logging thread is properly joined to ensure all pending log messages are written before the process terminates.</li>
<li><strong>Maximum guards</strong>: The system supports up to 255 concurrent <code>LogGuard</code> instances. Attempting to create more will cause a panic.</li>
</ul>
<p>This mechanism ensures that:</p>
<ol>
<li>Log messages are never lost due to premature thread termination.</li>
<li>The logging thread remains active as long as any <code>LogGuard</code> exists.</li>
<li>All buffered logs are properly flushed to their destinations when the program ends.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="why-use-logguard">Why use LogGuard?<a href="#why-use-logguard" class="hash-link" aria-label="Why use LogGuard?的直接链接" title="Why use LogGuard?的直接链接" translate="no">​</a></h3>
<p>Without a <code>LogGuard</code>, any attempt to run sequential engines in the same process may result in errors such as:</p>
<div class="language-text codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-text codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">Error sending log event: [INFO] ...</span><br></span></code></pre></div></div>
<p>This occurs because the logging subsystem&#x27;s underlying channel and Rust <code>Logger</code> are closed when the first engine is disposed.
As a result, subsequent engines lose access to the logging subsystem, leading to these errors.</p>
<p>By leveraging a <code>LogGuard</code>, you can ensure robust logging behavior across multiple backtests or engine runs in the same process.
The <code>LogGuard</code> retains the resources of the logging subsystem and ensures that logs continue to function correctly,
even as engines are disposed and initialized.</p>
<div class="theme-admonition theme-admonition-note admonition_lEzE alert alert--secondary"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>备注</div><div class="admonitionContent_Vfkp"><p>Using <code>LogGuard</code> is critical to maintain consistent logging behavior throughout a process with multiple engines.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="running-multiple-engines">Running multiple engines<a href="#running-multiple-engines" class="hash-link" aria-label="Running multiple engines的直接链接" title="Running multiple engines的直接链接" translate="no">​</a></h2>
<p>The following example demonstrates how to use a <code>LogGuard</code> when running multiple engines sequentially in the same process:</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">log_guard </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Initialize LogGuard reference</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number_of_backtests</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    engine </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> setup_engine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Assign reference to LogGuard</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> log_guard </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_guard </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> engine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_log_guard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Add actors and execute the engine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    actors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> setup_actors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    engine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_actors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    engine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    engine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dispose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Dispose safely</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="steps">Steps<a href="#steps" class="hash-link" aria-label="Steps的直接链接" title="Steps的直接链接" translate="no">​</a></h3>
<ul>
<li><strong>Initialize LogGuard once</strong>: The <code>LogGuard</code> is obtained from the first engine (<code>engine.get_log_guard()</code>) and is retained throughout the process. This ensures that the logging subsystem remains active.</li>
<li><strong>Dispose engines safely</strong>: Each engine is safely disposed of after its backtest completes, without affecting the logging subsystem.</li>
<li><strong>Reuse LogGuard</strong>: The same <code>LogGuard</code> instance is reused for subsequent engines, preventing the logging subsystem from shutting down prematurely.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="considerations">Considerations<a href="#considerations" class="hash-link" aria-label="Considerations的直接链接" title="Considerations的直接链接" translate="no">​</a></h3>
<ul>
<li><strong>Multiple LogGuards per process</strong>: The system supports up to 255 concurrent <code>LogGuard</code> instances per process. Each guard increments a reference counter when created and decrements it when dropped.</li>
<li><strong>Thread safety</strong>: The logging subsystem, including <code>LogGuard</code>, is thread-safe, ensuring consistent behavior even in multi-threaded environments.</li>
<li><strong>Automatic cleanup</strong>: When the last <code>LogGuard</code> is dropped (reference count reaches zero), the logging thread is properly joined to ensure all pending logs are written before the process terminates.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="platform-specific-considerations">Platform-specific considerations<a href="#platform-specific-considerations" class="hash-link" aria-label="Platform-specific considerations的直接链接" title="Platform-specific considerations的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="windows-shutdown-behavior">Windows shutdown behavior<a href="#windows-shutdown-behavior" class="hash-link" aria-label="Windows shutdown behavior的直接链接" title="Windows shutdown behavior的直接链接" translate="no">​</a></h3>
<p>On Windows, non-deterministic garbage collection during interpreter shutdown can occasionally
prevent the logging thread from joining properly. When the last <code>LogGuard</code> is dropped, the
logging subsystem signals the background thread to close and joins it to ensure all pending
messages are written. If Python&#x27;s garbage collector delays dropping the guard until after
interpreter shutdown has begun, this join may not complete, resulting in truncated logs.</p>
<p>This issue is tracked in GitHub <a href="https://github.com/nautechsystems/nautilus_trader/issues/3027" target="_blank" rel="noopener noreferrer">issue #3027</a>.
A more deterministic shutdown mechanism is under consideration.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Aloento/NautilusTraderDoc/tree/main/docs/concepts/logging.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_F7ru" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_GNoA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/concepts/live"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Live Trading</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/concepts/message_bus"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Message Bus</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_pg_n thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#standard-output-logging" class="table-of-contents__link toc-highlight">Standard output logging</a></li><li><a href="#file-logging" class="table-of-contents__link toc-highlight">File logging</a></li><li><a href="#component-log-filtering" class="table-of-contents__link toc-highlight">Component log filtering</a></li><li><a href="#components-only-logging" class="table-of-contents__link toc-highlight">Components-only logging</a></li><li><a href="#log-colors" class="table-of-contents__link toc-highlight">Log Colors</a></li></ul></li><li><a href="#using-a-logger-directly" class="table-of-contents__link toc-highlight">Using a logger directly</a></li><li><a href="#logguard-managing-log-lifecycle" class="table-of-contents__link toc-highlight">LogGuard: managing log lifecycle</a><ul><li><a href="#reference-counting-implementation" class="table-of-contents__link toc-highlight">Reference Counting Implementation</a></li><li><a href="#why-use-logguard" class="table-of-contents__link toc-highlight">Why use LogGuard?</a></li></ul></li><li><a href="#running-multiple-engines" class="table-of-contents__link toc-highlight">Running multiple engines</a><ul><li><a href="#steps" class="table-of-contents__link toc-highlight">Steps</a></li><li><a href="#considerations" class="table-of-contents__link toc-highlight">Considerations</a></li></ul></li><li><a href="#platform-specific-considerations" class="table-of-contents__link toc-highlight">Platform-specific considerations</a><ul><li><a href="#windows-shutdown-behavior" class="table-of-contents__link toc-highlight">Windows shutdown behavior</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 NautilusTrader Documentation.</div></div></div></footer></div>
</body>
</html>
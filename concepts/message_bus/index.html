<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-concepts/message_bus" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Message Bus | NautilusTrader 文档</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nautilus.aloen.to/concepts/message_bus"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Message Bus | NautilusTrader 文档"><meta data-rh="true" name="description" content="The MessageBus is a fundamental part of the platform, enabling communication between system components"><meta data-rh="true" property="og:description" content="The MessageBus is a fundamental part of the platform, enabling communication between system components"><link data-rh="true" rel="icon" href="/logo.png"><link data-rh="true" rel="canonical" href="https://nautilus.aloen.to/concepts/message_bus"><link data-rh="true" rel="alternate" href="https://nautilus.aloen.to/concepts/message_bus" hreflang="zh"><link data-rh="true" rel="alternate" href="https://nautilus.aloen.to/concepts/message_bus" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Concepts","item":"https://nautilus.aloen.to/concepts/"},{"@type":"ListItem","position":2,"name":"Message Bus","item":"https://nautilus.aloen.to/concepts/message_bus"}]}</script><link rel="stylesheet" href="/assets/css/styles.33db920f.css">
<script src="/assets/js/runtime~main.eefcc7db.js" defer="defer"></script>
<script src="/assets/js/main.3352860b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/logo.png"><div role="region" aria-label="跳到主要内容"><a class="skipToContent__uWo" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo.png" alt="NautilusTrader Logo" class="themedComponent_WkLn themedComponent--light_cjoX"><img src="/logo.png" alt="NautilusTrader Logo" class="themedComponent_WkLn themedComponent--dark_jZId"></div><b class="navbar__title text--truncate">NautilusTrader</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/api_reference/">文档</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Aloento/NautilusTraderDoc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_KfBJ"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_RWFU colorModeToggle_sA1q"><button class="clean-btn toggleButton_qjfc toggleButtonDisabled_cpNp" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX lightToggleIcon_UYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX darkToggleIcon_i1s2"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_CetX systemToggleIcon_yIQx"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_PsjF"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_jk42"><div class="docsWrapper_KWBO"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_XpKL" type="button"></button><div class="docRoot_joIP"><aside class="theme-doc-sidebar-container docSidebarContainer_DOen"><div class="sidebarViewport_j7YP"><div class="sidebar_nPgc"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_MTDt"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/api_reference/"><span title="Python API" class="categoryLinkLabel_XKxb">Python API</span></a><button aria-label="展开侧边栏分类 &#x27;Python API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist menu__link--active" href="/concepts/"><span title="Concepts" class="categoryLinkLabel_XKxb">Concepts</span></a><button aria-label="折叠侧边栏分类 &#x27;Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/actors"><span title="Actors" class="linkLabel_CNtA">Actors</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/adapters"><span title="Adapters" class="linkLabel_CNtA">Adapters</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/architecture"><span title="Architecture" class="linkLabel_CNtA">Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/backtesting"><span title="Backtesting" class="linkLabel_CNtA">Backtesting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/cache"><span title="Cache" class="linkLabel_CNtA">Cache</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/data"><span title="Data" class="linkLabel_CNtA">Data</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/execution"><span title="Execution" class="linkLabel_CNtA">Execution</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/instruments"><span title="Instruments" class="linkLabel_CNtA">Instruments</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/live"><span title="Live Trading" class="linkLabel_CNtA">Live Trading</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/logging"><span title="Logging" class="linkLabel_CNtA">Logging</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/concepts/message_bus"><span title="Message Bus" class="linkLabel_CNtA">Message Bus</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/orders"><span title="Orders" class="linkLabel_CNtA">Orders</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/overview"><span title="Overview" class="linkLabel_CNtA">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/portfolio"><span title="Portfolio" class="linkLabel_CNtA">Portfolio</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/positions"><span title="Positions" class="linkLabel_CNtA">Positions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/reports"><span title="Reports" class="linkLabel_CNtA">Reports</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/concepts/strategies"><span title="Strategies" class="linkLabel_CNtA">Strategies</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/developer_guide/"><span title="Developer Guide" class="categoryLinkLabel_XKxb">Developer Guide</span></a><button aria-label="展开侧边栏分类 &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/getting_started/"><span title="入门" class="categoryLinkLabel_XKxb">入门</span></a><button aria-label="展开侧边栏分类 &#x27;入门&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/integrations/"><span title="Integrations" class="categoryLinkLabel_XKxb">Integrations</span></a><button aria-label="展开侧边栏分类 &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_GgI9 menu__link menu__link--sublist" href="/tutorials/"><span title="教程" class="categoryLinkLabel_XKxb">教程</span></a><button aria-label="展开侧边栏分类 &#x27;教程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_bw1l"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_PIhC"><div class="docItemContainer_pFw3"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_HRKZ" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_sX5c"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/concepts/"><span>Concepts</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Message Bus</span></li></ul></nav><div class="tocCollapsible_DhUt theme-doc-toc-mobile tocMobile_Izjv"><button type="button" class="clean-btn tocCollapsibleButton_eYR5">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Message Bus</h1></header>
<p>The <code>MessageBus</code> is a fundamental part of the platform, enabling communication between system components
through message passing. This design creates a loosely coupled architecture where components can interact
without direct dependencies.</p>
<p>The <em>messaging patterns</em> include:</p>
<ul>
<li>Point-to-Point</li>
<li>Publish/Subscribe</li>
<li>Request/Response</li>
</ul>
<p>Messages exchanged via the <code>MessageBus</code> fall into three categories:</p>
<ul>
<li>Data</li>
<li>Events</li>
<li>Commands</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="data-and-signal-publishing">Data and signal publishing<a href="#data-and-signal-publishing" class="hash-link" aria-label="Data and signal publishing的直接链接" title="Data and signal publishing的直接链接" translate="no">​</a></h2>
<p>While the <code>MessageBus</code> is a lower-level component that users typically interact with indirectly,
<code>Actor</code> and <code>Strategy</code> classes provide convenient methods built on top of it:</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">publish_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DataType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">publish_signal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ts_event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><br></span></code></pre></div></div>
<p>These methods allow you to publish custom data and signals efficiently without needing to work directly with the <code>MessageBus</code> interface.</p>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="direct-access">Direct access<a href="#direct-access" class="hash-link" aria-label="Direct access的直接链接" title="Direct access的直接链接" translate="no">​</a></h2>
<p>For advanced users or specialized use cases, direct access to the message bus is available within <code>Actor</code> and <code>Strategy</code>
classes through the <code>self.msgbus</code> reference, which provides the full message bus interface.</p>
<p>To publish a custom message directly, you can specify a topic as a <code>str</code> and any Python <code>object</code> as the message payload, for example:</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">msgbus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MyTopic&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MyMessage&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="messaging-styles">Messaging styles<a href="#messaging-styles" class="hash-link" aria-label="Messaging styles的直接链接" title="Messaging styles的直接链接" translate="no">​</a></h2>
<p>NautilusTrader is an <strong>event-driven</strong> framework where components communicate by sending and receiving messages.
Understanding the different messaging styles is crucial for building effective trading systems.</p>
<p>This guide explains the three primary messaging patterns available in NautilusTrader:</p>
<table><thead><tr><th style="text-align:left"><strong>Messaging Style</strong></th><th style="text-align:left"><strong>Purpose</strong></th><th style="text-align:left"><strong>Best For</strong></th></tr></thead><tbody><tr><td style="text-align:left"><strong>MessageBus - Publish/Subscribe to topics</strong></td><td style="text-align:left">Low-level, direct access to the message bus</td><td style="text-align:left">Custom events, system-level communication</td></tr><tr><td style="text-align:left"><strong>Actor-Based - Publish/Subscribe Data</strong></td><td style="text-align:left">Structured trading data exchange</td><td style="text-align:left">Trading metrics, indicators, data needing persistence</td></tr><tr><td style="text-align:left"><strong>Actor-Based - Publish/Subscribe Signal</strong></td><td style="text-align:left">Lightweight notifications</td><td style="text-align:left">Simple alerts, flags, status updates</td></tr></tbody></table>
<p>Each approach serves different purposes and offers unique advantages. This guide will help you decide which messaging
pattern to use in your NautilusTrader applications.</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="messagebus-publishsubscribe-to-topics">MessageBus publish/subscribe to topics<a href="#messagebus-publishsubscribe-to-topics" class="hash-link" aria-label="MessageBus publish/subscribe to topics的直接链接" title="MessageBus publish/subscribe to topics的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="concept">Concept<a href="#concept" class="hash-link" aria-label="Concept的直接链接" title="Concept的直接链接" translate="no">​</a></h4>
<p>The <code>MessageBus</code> is the central hub for all messages in NautilusTrader. It enables a <strong>publish/subscribe</strong> pattern
where components can publish events to <strong>named topics</strong>, and other components can subscribe to receive those messages.
This decouples components, allowing them to interact indirectly via the message bus.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="key-benefits-and-use-cases">Key benefits and use cases<a href="#key-benefits-and-use-cases" class="hash-link" aria-label="Key benefits and use cases的直接链接" title="Key benefits and use cases的直接链接" translate="no">​</a></h4>
<p>The message bus approach is ideal when you need:</p>
<ul>
<li><strong>Cross-component communication</strong> within the system.</li>
<li><strong>Flexibility</strong> to define any topic and send any type of payload (any Python object).</li>
<li><strong>Decoupling</strong> between publishers and subscribers who don&#x27;t need to know about each other.</li>
<li><strong>Global Reach</strong> where messages can be received by multiple subscribers.</li>
<li>Working with events that don&#x27;t fit within the predefined <code>Actor</code> model.</li>
<li>Advanced scenarios requiring full control over messaging.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="considerations">Considerations<a href="#considerations" class="hash-link" aria-label="Considerations的直接链接" title="Considerations的直接链接" translate="no">​</a></h4>
<ul>
<li>You must track topic names manually (typos could result in missed messages).</li>
<li>You must define handlers manually.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="quick-overview-code">Quick overview code<a href="#quick-overview-code" class="hash-link" aria-label="Quick overview code的直接链接" title="Quick overview code的直接链接" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define a custom event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Each10thBarEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TOPIC </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;each_10th_bar&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Topic name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Subscribe in a component (in Strategy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">msgbus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Each10thBarEvent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TOPIC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">on_each_10th_bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Publish an event (in Strategy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">event </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Each10thBarEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">msgbus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Each10thBarEvent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TOPIC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Handler (in Strategy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">on_each_10th_bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Each10thBarEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Received 10th bar: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">bar</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="full-example">Full example<a href="#full-example" class="hash-link" aria-label="Full example的直接链接" title="Full example的直接链接" translate="no">​</a></h4>
<p><a href="https://github.com/nautechsystems/nautilus_trader/tree/develop/examples/backtest/example_09_messaging_with_msgbus" target="_blank" rel="noopener noreferrer">MessageBus Example</a></p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="actor-based-publishsubscribe-data">Actor-based publish/subscribe data<a href="#actor-based-publishsubscribe-data" class="hash-link" aria-label="Actor-based publish/subscribe data的直接链接" title="Actor-based publish/subscribe data的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="concept-1">Concept<a href="#concept-1" class="hash-link" aria-label="Concept的直接链接" title="Concept的直接链接" translate="no">​</a></h4>
<p>This approach provides a way to exchange trading specific data between <code>Actor</code>s in the system.
(note: each <code>Strategy</code> inherits from <code>Actor</code>). It inherits from <code>Data</code>, which ensures proper timestamping
and ordering of events - crucial for correct backtest processing.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="key-benefits-and-use-cases-1">Key Benefits and Use Cases<a href="#key-benefits-and-use-cases-1" class="hash-link" aria-label="Key Benefits and Use Cases的直接链接" title="Key Benefits and Use Cases的直接链接" translate="no">​</a></h4>
<p>The Data publish/subscribe approach excels when you need:</p>
<ul>
<li><strong>Exchange of structured trading data</strong> like market data, indicators, custom metrics, or option greeks.</li>
<li><strong>Proper event ordering</strong> via built-in timestamps (<code>ts_event</code>, <code>ts_init</code>) crucial for backtest accuracy.</li>
<li><strong>Data persistence and serialization</strong> through the <code>@customdataclass</code> decorator, integrating seamlessly with NautilusTrader&#x27;s data catalog system.</li>
<li><strong>Standardized trading data exchange</strong> between system components.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="considerations-1">Considerations<a href="#considerations-1" class="hash-link" aria-label="Considerations的直接链接" title="Considerations的直接链接" translate="no">​</a></h4>
<ul>
<li>Requires defining a class that inherits from <code>Data</code> or uses <code>@customdataclass</code>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="inheriting-from-data-vs-using-customdataclass">Inheriting from <code>Data</code> vs. using <code>@customdataclass</code><a href="#inheriting-from-data-vs-using-customdataclass" class="hash-link" aria-label="inheriting-from-data-vs-using-customdataclass的直接链接" title="inheriting-from-data-vs-using-customdataclass的直接链接" translate="no">​</a></h4>
<p><strong>Inheriting from <code>Data</code> class:</strong></p>
<ul>
<li>Defines abstract properties <code>ts_event</code> and <code>ts_init</code> that must be implemented by the subclass. These ensure proper data ordering in backtests based on timestamps.</li>
</ul>
<p><strong>The <code>@customdataclass</code> decorator:</strong></p>
<ul>
<li>Adds <code>ts_event</code> and <code>ts_init</code> attributes if they are not already present.</li>
<li>Provides serialization functions: <code>to_dict()</code>, <code>from_dict()</code>, <code>to_bytes()</code>, <code>to_arrow()</code>, etc.</li>
<li>Enables data persistence and external communication.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="quick-overview-code-1">Quick overview code<a href="#quick-overview-code-1" class="hash-link" aria-label="Quick overview code的直接链接" title="Quick overview code的直接链接" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">custom </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> customdataclass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@customdataclass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">GreeksData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delta</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gamma</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Publish data (in Actor / Strategy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GreeksData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">delta</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.75</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> gamma</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ts_event</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1_630_000_000_000_000_000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ts_init</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1_630_000_000_000_000_000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publish_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GreeksData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Subscribe to receiving data  (in Actor / Strategy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GreeksData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Handler (this is static callback function with fixed name)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">on_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GreeksData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Delta: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">data</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">delta</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, Gamma: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">data</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">gamma</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="full-example-1">Full example<a href="#full-example-1" class="hash-link" aria-label="Full example的直接链接" title="Full example的直接链接" translate="no">​</a></h4>
<p><a href="https://github.com/nautechsystems/nautilus_trader/tree/develop/examples/backtest/example_10_messaging_with_actor_data" target="_blank" rel="noopener noreferrer">Actor-Based Data Example</a></p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="actor-based-publishsubscribe-signal">Actor-based publish/subscribe signal<a href="#actor-based-publishsubscribe-signal" class="hash-link" aria-label="Actor-based publish/subscribe signal的直接链接" title="Actor-based publish/subscribe signal的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="concept-2">Concept<a href="#concept-2" class="hash-link" aria-label="Concept的直接链接" title="Concept的直接链接" translate="no">​</a></h4>
<p><strong>Signals</strong> are a lightweight way to publish and subscribe to simple notifications within the actor framework.
This is the simplest messaging approach, requiring no custom class definitions.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="key-benefits-and-use-cases-2">Key Benefits and Use Cases<a href="#key-benefits-and-use-cases-2" class="hash-link" aria-label="Key Benefits and Use Cases的直接链接" title="Key Benefits and Use Cases的直接链接" translate="no">​</a></h4>
<p>The Signal messaging approach shines when you need:</p>
<ul>
<li><strong>Simple, lightweight notifications/alerts</strong> like &quot;RiskThresholdExceeded&quot; or &quot;TrendUp&quot;.</li>
<li><strong>Quick, on-the-fly messaging</strong> without defining custom classes.</li>
<li><strong>Broadcasting alerts or flags</strong> as primitive data (<code>int</code>, <code>float</code>, or <code>str</code>).</li>
<li><strong>Easy API integration</strong> with straightforward methods (<code>publish_signal</code>, <code>subscribe_signal</code>).</li>
<li><strong>Multiple subscriber communication</strong> where all subscribers receive signals when published.</li>
<li><strong>Minimal setup overhead</strong> with no class definitions required.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="considerations-2">Considerations<a href="#considerations-2" class="hash-link" aria-label="Considerations的直接链接" title="Considerations的直接链接" translate="no">​</a></h4>
<ul>
<li>Each signal can contain only <strong>single value</strong> of type: <code>int</code>, <code>float</code>, and <code>str</code>. That means no support for complex data structures or other Python types.</li>
<li>In the <code>on_signal</code> handler, you can only differentiate between signals using <code>signal.value</code>, as the signal name is not accessible in the handler.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="quick-overview-code-2">Quick overview code<a href="#quick-overview-code-2" class="hash-link" aria-label="Quick overview code的直接链接" title="Quick overview code的直接链接" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Define signal constants for better organization (optional but recommended)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> types</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">datetime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> unix_nanos_to_dt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enums </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> LogColor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signals </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SimpleNamespace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_HIGHEST_PRICE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;NewHighestPriceReached&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_LOWEST_PRICE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;NewLowestPriceReached&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Subscribe to signals (in Actor/Strategy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe_signal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_HIGHEST_PRICE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe_signal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_LOWEST_PRICE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Publish a signal (in Actor/Strategy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">publish_signal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_HIGHEST_PRICE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    value</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_HIGHEST_PRICE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># value can be the same as name for simplicity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ts_event</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ts_event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># timestamp from triggering event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Handler (this is static callback function with fixed name)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">on_signal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># IMPORTANT: We match against signal.value, not signal.name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">match</span><span class="token plain"> signal</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_HIGHEST_PRICE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;New highest price was reached. | &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Signal value: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">signal</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">value</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> | &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Signal time: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">unix_nanos_to_dt</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">signal</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">ts_event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                color</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LogColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GREEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> signals</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW_LOWEST_PRICE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;New lowest price was reached. | &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Signal value: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">signal</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">value</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> | &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Signal time: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">unix_nanos_to_dt</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">signal</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">ts_event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                color</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LogColor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="full-example-2">Full example<a href="#full-example-2" class="hash-link" aria-label="Full example的直接链接" title="Full example的直接链接" translate="no">​</a></h4>
<p><a href="https://github.com/nautechsystems/nautilus_trader/tree/develop/examples/backtest/example_11_messaging_with_actor_signals" target="_blank" rel="noopener noreferrer">Actor-Based Signal Example</a></p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="summary-and-decision-guide">Summary and decision guide<a href="#summary-and-decision-guide" class="hash-link" aria-label="Summary and decision guide的直接链接" title="Summary and decision guide的直接链接" translate="no">​</a></h3>
<p>Here&#x27;s a quick reference to help you decide which messaging style to use:</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="decision-guide-which-style-to-choose">Decision guide: Which style to choose?<a href="#decision-guide-which-style-to-choose" class="hash-link" aria-label="Decision guide: Which style to choose?的直接链接" title="Decision guide: Which style to choose?的直接链接" translate="no">​</a></h4>
<table><thead><tr><th style="text-align:left"><strong>Use Case</strong></th><th style="text-align:left"><strong>Recommended Approach</strong></th><th style="text-align:left"><strong>Setup required</strong></th></tr></thead><tbody><tr><td style="text-align:left">Custom events or system-level communication</td><td style="text-align:left"><code>MessageBus</code> + Pub/Sub to topic</td><td style="text-align:left">Topic + Handler management</td></tr><tr><td style="text-align:left">Structured trading data</td><td style="text-align:left"><code>Actor</code> + Pub/Sub Data + optional <code>@customdataclass</code> if serialization is needed</td><td style="text-align:left">New class definition inheriting from <code>Data</code> (handler <code>on_data</code> is predefined)</td></tr><tr><td style="text-align:left">Simple alerts/notifications</td><td style="text-align:left"><code>Actor</code> + Pub/Sub Signal</td><td style="text-align:left">Just signal name</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="external-publishing">External publishing<a href="#external-publishing" class="hash-link" aria-label="External publishing的直接链接" title="External publishing的直接链接" translate="no">​</a></h2>
<p>The <code>MessageBus</code> can be <em>backed</em> with any database or message broker technology which has an
integration written for it, this then enables external publishing of messages.</p>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p>Redis is currently supported for all serializable messages which are published externally.
The minimum supported Redis version is 6.2 (required for <a href="https://redis.io/docs/latest/develop/data-types/streams/" target="_blank" rel="noopener noreferrer">streams</a> functionality).</p></div></div>
<p>Under the hood, when a backing database (or any other compatible technology) is configured,
all outgoing messages are first serialized, then transmitted via a Multiple-Producer Single-Consumer (MPSC) channel to a separate thread (implemented in Rust).
In this separate thread, the message is written to its final destination, which is presently Redis streams.</p>
<p>This design is primarily driven by performance considerations. By offloading the I/O operations to a separate thread,
we ensure that the main thread remains unblocked and can continue its tasks without being hindered by the potentially
time-consuming operations involved in interacting with a database or client.</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="serialization">Serialization<a href="#serialization" class="hash-link" aria-label="Serialization的直接链接" title="Serialization的直接链接" translate="no">​</a></h3>
<p>Nautilus supports serialization for:</p>
<ul>
<li>All Nautilus built-in types (serialized as dictionaries <code>dict[str, Any]</code> containing serializable primitives).</li>
<li>Python primitive types (<code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code>, <code>bytes</code>).</li>
</ul>
<p>You can add serialization support for custom types by registering them through the <code>serialization</code> subpackage.</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">register_serializable_type</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    to_dict</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Callable</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    from_dict</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Callable</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre></div></div>
<ul>
<li><code>cls</code>: The type to register.</li>
<li><code>to_dict</code>: The delegate to instantiate a dict of primitive types from the object.</li>
<li><code>from_dict</code>: The delegate to instantiate the object from a dict of primitive types.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Configuration的直接链接" title="Configuration的直接链接" translate="no">​</a></h2>
<p>The message bus external backing technology can be configured by importing the <code>MessageBusConfig</code> object and passing this to
your <code>TradingNodeConfig</code>. Each of these config options will be described below.</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Other config omitted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message_bus</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">MessageBusConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">DatabaseConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timestamps_as_iso8601</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buffer_interval_ms</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    autotrim_mins</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use_trader_prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use_trader_id</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use_instance_id</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    streams_prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;streams&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    types_filter</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">QuoteTick</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TradeTick</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="database-config">Database config<a href="#database-config" class="hash-link" aria-label="Database config的直接链接" title="Database config的直接链接" translate="no">​</a></h3>
<p>A <code>DatabaseConfig</code> must be provided, for a default Redis setup on the local
loopback you can pass a <code>DatabaseConfig()</code>, which will use defaults to match.</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="encoding">Encoding<a href="#encoding" class="hash-link" aria-label="Encoding的直接链接" title="Encoding的直接链接" translate="no">​</a></h3>
<p>Two encodings are currently supported by the built-in <code>Serializer</code> used by the <code>MessageBus</code>:</p>
<ul>
<li>JSON (<code>json</code>)</li>
<li>MessagePack (<code>msgpack</code>)</li>
</ul>
<p>Use the <code>encoding</code> config option to control the message writing encoding.</p>
<div class="theme-admonition theme-admonition-tip admonition_lEzE alert alert--success"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_Vfkp"><p>The <code>msgpack</code> encoding is used by default as it offers the most optimal serialization and memory performance.
We recommend using <code>json</code> encoding for human readability when performance is not a primary concern.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="timestamp-formatting">Timestamp formatting<a href="#timestamp-formatting" class="hash-link" aria-label="Timestamp formatting的直接链接" title="Timestamp formatting的直接链接" translate="no">​</a></h3>
<p>By default timestamps are formatted as UNIX epoch nanosecond integers. Alternatively you can
configure ISO 8601 string formatting by setting the <code>timestamps_as_iso8601</code> to <code>True</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="message-stream-keys">Message stream keys<a href="#message-stream-keys" class="hash-link" aria-label="Message stream keys的直接链接" title="Message stream keys的直接链接" translate="no">​</a></h3>
<p>Message stream keys are essential for identifying individual trader nodes and organizing messages within streams.
They can be tailored to meet your specific requirements and use cases. In the context of message bus streams, a trader key is typically structured as follows:</p>
<div class="language-text codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-text codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">trader:{trader_id}:{instance_id}:{streams_prefix}</span><br></span></code></pre></div></div>
<p>The following options are available for configuring message stream keys:</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="trader-prefix">Trader prefix<a href="#trader-prefix" class="hash-link" aria-label="Trader prefix的直接链接" title="Trader prefix的直接链接" translate="no">​</a></h4>
<p>If the key should begin with the <code>trader</code> string.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="trader-id">Trader ID<a href="#trader-id" class="hash-link" aria-label="Trader ID的直接链接" title="Trader ID的直接链接" translate="no">​</a></h4>
<p>If the key should include the trader ID for the node.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="instance-id">Instance ID<a href="#instance-id" class="hash-link" aria-label="Instance ID的直接链接" title="Instance ID的直接链接" translate="no">​</a></h4>
<p>Each trader node is assigned a unique &#x27;instance ID,&#x27; which is a UUIDv4. This instance ID helps distinguish individual traders when messages
are distributed across multiple streams. You can include the instance ID in the trader key by setting the <code>use_instance_id</code> configuration option to <code>True</code>.
This is particularly useful when you need to track and identify traders across various streams in a multi-node trading system.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="streams-prefix">Streams prefix<a href="#streams-prefix" class="hash-link" aria-label="Streams prefix的直接链接" title="Streams prefix的直接链接" translate="no">​</a></h4>
<p>The <code>streams_prefix</code> string enables you to group all streams for a single trader instance or organize
messages for multiple instances. Configure this by passing a string to the <code>streams_prefix</code> configuration
option, ensuring other prefixes are set to false.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="stream-per-topic">Stream per topic<a href="#stream-per-topic" class="hash-link" aria-label="Stream per topic的直接链接" title="Stream per topic的直接链接" translate="no">​</a></h4>
<p>Indicates whether the producer will write a separate stream for each topic. This is particularly
useful for Redis backings, which do not support wildcard topics when listening to streams.
If set to False, all messages will be written to the same stream.</p>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p>Redis does not support wildcard stream topics. For better compatibility with Redis, it is recommended to set this option to False.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="types-filtering">Types filtering<a href="#types-filtering" class="hash-link" aria-label="Types filtering的直接链接" title="Types filtering的直接链接" translate="no">​</a></h3>
<p>When messages are published on the message bus, they are serialized and written to a stream if a backing
for the message bus is configured and enabled. To prevent flooding the stream with data like high-frequency
quotes, you may filter out certain types of messages from external publication.</p>
<p>To enable this filtering mechanism, pass a list of <code>type</code> objects to the <code>types_filter</code> parameter in the message bus configuration,
specifying which types of messages should be excluded from external publication.</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">config </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MessageBusConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> TradeTick</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> nautilus_trader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> QuoteTick</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create a MessageBusConfig instance with types filtering</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message_bus </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MessageBusConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    types_filter</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">QuoteTick</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TradeTick</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="stream-auto-trimming">Stream auto-trimming<a href="#stream-auto-trimming" class="hash-link" aria-label="Stream auto-trimming的直接链接" title="Stream auto-trimming的直接链接" translate="no">​</a></h3>
<p>The <code>autotrim_mins</code> configuration parameter allows you to specify the lookback window in minutes for automatic stream trimming in your message streams.
Automatic stream trimming helps manage the size of your message streams by removing older messages, ensuring that the streams remain manageable in terms of storage and performance.</p>
<div class="theme-admonition theme-admonition-info admonition_lEzE alert alert--info"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_Vfkp"><p>The current Redis implementation will maintain the <code>autotrim_mins</code> as a maximum width (plus roughly a minute, as streams are trimmed no more than once per minute).
Rather than a maximum lookback window based on the current wall clock time.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_RpWm" id="external-streams">External streams<a href="#external-streams" class="hash-link" aria-label="External streams的直接链接" title="External streams的直接链接" translate="no">​</a></h2>
<p>The message bus within a <code>TradingNode</code> (node) is referred to as the &quot;internal message bus&quot;.
A producer node is one which publishes messages onto an external stream (see <a href="#external-publishing">external publishing</a>).
The consumer node listens to external streams to receive and publish deserialized message payloads on its internal message bus.</p>
<div class="language-text codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-text codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">                  ┌───────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │      Producer Node        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  └─────────────┬─────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌───────────────────────────────▼──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                            Stream                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────┬────────────────────────────────────┬───────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              │                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              │                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────▼───────────┐          ┌─────────────▼───────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     Consumer Node 1     │          │     Consumer Node 2     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                         │          │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────┘          └─────────────────────────┘</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_lEzE alert alert--success"><div class="admonitionHeading_aAf0"><span class="admonitionIcon_xtBN"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_Vfkp"><p>Set the <code>LiveDataEngineConfig.external_clients</code> with the list of <code>client_id</code>s intended to represent the external streaming clients.
The <code>DataEngine</code> will filter out subscription commands for these clients, ensuring that the external streaming provides the necessary data for any subscriptions to these clients.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_RpWm" id="example-configuration">Example configuration<a href="#example-configuration" class="hash-link" aria-label="Example configuration的直接链接" title="Example configuration的直接链接" translate="no">​</a></h3>
<p>The following example details a streaming setup where a producer node publishes Binance data externally,
and a downstream consumer node publishes these data messages onto its internal message bus.</p>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="producer-node">Producer node<a href="#producer-node" class="hash-link" aria-label="Producer node的直接链接" title="Producer node的直接链接" translate="no">​</a></h4>
<p>We configure the <code>MessageBus</code> of the producer node to publish to a <code>&quot;binance&quot;</code> stream.
The settings <code>use_trader_id</code>, <code>use_trader_prefix</code>, and <code>use_instance_id</code> are all set to <code>False</code>
to ensure a simple and predictable stream key that the consumer nodes can register for.</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">message_bus</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">MessageBusConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">DatabaseConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use_trader_id</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use_trader_prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use_instance_id</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    streams_prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;binance&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># &lt;---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stream_per_topic</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    autotrim_mins</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_RpWm" id="consumer-node">Consumer node<a href="#consumer-node" class="hash-link" aria-label="Consumer node的直接链接" title="Consumer node的直接链接" translate="no">​</a></h4>
<p>We configure the <code>MessageBus</code> of the consumer node to receive messages from the same <code>&quot;binance&quot;</code> stream.
The node will listen to the external stream keys to publish these messages onto its internal message bus.
Additionally, we declare the client ID <code>&quot;BINANCE_EXT&quot;</code> as an external client. This ensures that the
<code>DataEngine</code> does not attempt to send data commands to this client ID, as we expect these messages to be
published onto the internal message bus from the external stream, to which the node has subscribed to the relevant topics.</p>
<div class="language-python codeBlockContainer_euGm theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_zF3K"><pre tabindex="0" class="prism-code language-python codeBlock_G1mO thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_QZRj"><span class="token-line" style="color:#393A34"><span class="token plain">data_engine</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LiveDataEngineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_clients</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ClientId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;BINANCE_EXT&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message_bus</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">MessageBusConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">DatabaseConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_streams</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;binance&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># &lt;---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Aloento/NautilusTraderDoc/tree/main/docs/concepts/message_bus.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_F7ru" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_GNoA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/concepts/logging"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Logging</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/concepts/orders"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Orders</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_pg_n thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-and-signal-publishing" class="table-of-contents__link toc-highlight">Data and signal publishing</a></li><li><a href="#direct-access" class="table-of-contents__link toc-highlight">Direct access</a></li><li><a href="#messaging-styles" class="table-of-contents__link toc-highlight">Messaging styles</a><ul><li><a href="#messagebus-publishsubscribe-to-topics" class="table-of-contents__link toc-highlight">MessageBus publish/subscribe to topics</a></li><li><a href="#actor-based-publishsubscribe-data" class="table-of-contents__link toc-highlight">Actor-based publish/subscribe data</a></li><li><a href="#actor-based-publishsubscribe-signal" class="table-of-contents__link toc-highlight">Actor-based publish/subscribe signal</a></li><li><a href="#summary-and-decision-guide" class="table-of-contents__link toc-highlight">Summary and decision guide</a></li></ul></li><li><a href="#external-publishing" class="table-of-contents__link toc-highlight">External publishing</a><ul><li><a href="#serialization" class="table-of-contents__link toc-highlight">Serialization</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#database-config" class="table-of-contents__link toc-highlight">Database config</a></li><li><a href="#encoding" class="table-of-contents__link toc-highlight">Encoding</a></li><li><a href="#timestamp-formatting" class="table-of-contents__link toc-highlight">Timestamp formatting</a></li><li><a href="#message-stream-keys" class="table-of-contents__link toc-highlight">Message stream keys</a></li><li><a href="#types-filtering" class="table-of-contents__link toc-highlight">Types filtering</a></li><li><a href="#stream-auto-trimming" class="table-of-contents__link toc-highlight">Stream auto-trimming</a></li></ul></li><li><a href="#external-streams" class="table-of-contents__link toc-highlight">External streams</a><ul><li><a href="#example-configuration" class="table-of-contents__link toc-highlight">Example configuration</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 NautilusTrader Documentation.</div></div></div></footer></div>
</body>
</html>